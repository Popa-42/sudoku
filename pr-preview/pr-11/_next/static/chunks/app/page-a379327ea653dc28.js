(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1941:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>R});var n=r(5155),l=r(2115),a=r(2821),o=r(5889);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,a.$)(t))}let i=(e,t,r)=>Math.min(r,Math.max(t,e));function u(e,t,r,n){let l=null!=n?n-1:1/0;return{row:i(e.row+t,0,l),col:i(e.col+r,0,l)}}let c=["tl","tr","bl","br","tc","rc","bc","lc","cc"],d={tl:"absolute top-0 left-0 translate-x-0.5 translate-y-0.5",tr:"absolute top-0 right-0 -translate-x-0.5 translate-y-0.5",bl:"absolute bottom-0 left-0 translate-x-0.5 -translate-y-0.5",br:"absolute bottom-0 right-0 -translate-x-0.5 -translate-y-0.5",tc:"absolute top-0 left-1/2 -translate-x-1/2 translate-y-0.5",rc:"absolute right-0 top-1/2 -translate-y-1/2 -translate-x-0.5",bc:"absolute bottom-0 left-1/2 -translate-x-1/2 -translate-y-0.5",lc:"absolute left-0 top-1/2 -translate-y-1/2 translate-x-0.5",cc:"absolute inset-0 flex items-center justify-center"},f={red:"bg-red-200",orange:"bg-orange-200",yellow:"bg-yellow-200",green:"bg-green-200",cyan:"bg-cyan-200",blue:"bg-blue-200",violet:"bg-violet-200",pink:"bg-pink-200",black:"bg-slate-200",transparent:"bg-transparent"};function g(e){return Array.from({length:e},()=>Array(e).fill(!1))}function b(e){return e.some(e=>e.some(Boolean))}function h(e,t){return e.findIndex(e=>{let[r,n]=e;return r===t[0]&&n===t[1]})}function p(e,t){return -1===h(e,t)&&e.push(t),e}function v(e,t){return e.filter(e=>{let[r,n]=e;return r!==t[0]||n!==t[1]})}function m(e){let t=[];for(let r=0;r<e.length;r++)for(let n=0;n<e[r].length;n++)e[r][n]&&t.push([r,n]);return t}function x(e){return Array.from({length:e},()=>Array(e).fill(0))}function w(e){return Array.from({length:e},()=>Array.from({length:e},()=>Array(e+1).fill(0)))}function k(e,t){return b(e)?m(e):t?[t]:[]}let y=l.forwardRef(function(e,t){var r;let{size:a=9,className:o,presetGrid:i,editedGrid:y,pencilGrid:C,pencilMode:j=null,currentCell:N,selectedCells:A,onCellSelect:M,onSelectionChange:z,onCurrentCellChange:S,box:_,regions:D,cellClassName:E,dividerClassName:P="border-foreground",...R}=e;if(!Number.isInteger(a)||a<=0)throw Error("Size must be a positive integer.");if(D&&(D.length!==a||D.some(e=>e.length!==a)))throw Error('Invalid "regions": expected a size\xd7size matrix.');let I=(0,l.useMemo)(()=>g(a),[a]),[T,K]=(0,l.useState)(void 0),[B,F]=(0,l.useState)(I),[L,O]=(0,l.useState)([]),U=(0,l.useRef)(null),V=(0,l.useRef)(null),X=(0,l.useRef)(!1),$=(0,l.useRef)(null),[q,G]=(0,l.useState)(()=>x(a)),[H,Q]=(0,l.useState)(()=>w(a)),[Y,J]=(0,l.useState)(()=>w(a)),[W,Z]=(0,l.useState)(()=>Array.from({length:a},()=>Array.from({length:a},()=>[])));(0,l.useEffect)(()=>{F(I),K(void 0),O([]),G(x(a)),Q(w(a)),J(w(a)),Z(Array.from({length:a},()=>Array.from({length:a},()=>[])))},[a,I]);let ee=(0,l.useMemo)(()=>null!=_?_:function(e){if(9===e)return{rows:3,cols:3};let t=Math.floor(Math.sqrt(e));return t>1&&e%t==0?{rows:t,cols:e/t}:{rows:e,cols:1}}(a),[_,a]),et=(0,l.useMemo)(()=>{if(D)return(e,t)=>D[e][t];let e=ee.cols,t=ee.rows,r=Math.ceil(a/e);return(n,l)=>Math.floor(n/t)*r+Math.floor(l/e)},[D,ee,a]),er=null!=N?N:T,en=!(r=null!=A?A:B)||r.length!==a||r.some(e=>e.length!==a)?g(a):r,el=(0,l.useCallback)((e,t)=>{var r,n;return(null!=(n=null==i||null==(r=i[e])?void 0:r[t])?n:0)>0},[i]);(0,l.useEffect)(()=>{b(en)||(N||K(void 0),O([]),null==S||S(void 0))},[en,N,S]);let ea=(0,l.useCallback)((e,t)=>{var r;return!!(null==en||null==(r=en[e])?void 0:r[t])},[en]),eo=(0,l.useCallback)((e,t)=>{let r=["size-10","border","border-foreground","text-center","select-none","cursor-pointer"];E&&r.push(E);let n=[];if(D){let r=et(e,t),l=0===e||et(e-1,t)!==r,o=0===t||et(e,t-1)!==r,s=t===a-1||et(e,t+1)!==r,i=e===a-1||et(e+1,t)!==r;l&&n.push("border-t-2",P),o&&n.push("border-l-2",P),s&&n.push("border-r-2",P),i&&n.push("border-b-2",P)}else{let r=0===e||e%ee.rows==0,l=0===t||t%ee.cols==0,o=t===a-1||(t+1)%ee.cols==0,s=e===a-1||(e+1)%ee.rows==0;r&&n.push("border-t-2",P),l&&n.push("border-l-2",P),o&&n.push("border-r-2",P),s&&n.push("border-b-2",P)}return s(r.join(" "),n.join(" "))},[D,et,a,ee,P,E]),es=(0,l.useCallback)(e=>{A||F(e),null==z||z(e)},[A,z]),ei=(0,l.useCallback)(e=>{N||K(e),null==S||S(e)},[N,S]);(0,l.useImperativeHandle)(t,()=>({annotateColor:e=>{let t=k(en,er);t.length&&Z(r=>{let n=r.map(e=>e.map(e=>e.slice()));for(let[r,l]of t){let t=n[r][l],a=t.indexOf(e);a>=0?t.splice(a,1):t.push(e)}return n})},annotateClear:()=>{let e=k(en,er);e.length&&Z(t=>{let r=t.map(e=>e.map(e=>e.slice()));for(let[t,n]of e)r[t][n]=[];return r})}}),[en,er]);let eu=(0,l.useCallback)((e,t)=>Math.max(0,Math.min(t-1,e)),[]),ec=(0,l.useCallback)(e=>{let t=V.current;if(!t)return;let r=t.getBoundingClientRect(),n=e.clientX-r.left,l=e.clientY-r.top;if(n<0||l<0||n>r.width||l>r.height)return;let o=eu(Math.floor(n/r.width*a),a);return[eu(Math.floor(l/r.height*a),a),o]},[a,eu]),ed=(0,l.useCallback)(e=>{var t,r,n;let l=ec(e);if(!l)return;null==(t=U.current)||t.focus();let[o,s]=l,i=e.ctrlKey||e.metaKey,u=e.shiftKey,c=i?en.map(e=>e.slice()):g(a),d=c.map(e=>e.slice()),f=i?c[o][s]?"paint-erase":"paint-add":u?"rect":"paint-add",b={mode:f,start:[o,s],base:c,working:d,visited:new Set([o*a+s]),last:[o,s]};if("rect"===f)(d=g(a))[o][s]=!0,b.working=d,O([[o,s]]),es(d),ei([o,s]);else if("paint-add"===f)d[o][s]=!0,b.working=d,O(i?e=>p([...e],[o,s]):[[o,s]]),es(d.map(e=>e.slice())),ei([o,s]);else{d[o][s]=!1,b.working=d,O(e=>v(e,[o,s])),es(d.map(e=>e.slice()));let e=h(L,[o,s]),t=L.filter(e=>{let[t,r]=e;return t!==o||r!==s});ei(e>0?L[e-1]:t[t.length-1])}$.current=b,X.current=!0,null==(r=(n=e.currentTarget).setPointerCapture)||r.call(n,e.pointerId)},[en,a,es,ei,ec,L]),ef=(0,l.useCallback)(e=>{if(!$.current)return;let t=ec(e);if(!t)return;let[r,n]=t,l=$.current;if("rect"===l.mode){let[e,t]=l.start,o=Math.min(e,r),s=Math.max(e,r),i=Math.min(t,n),u=Math.max(t,n),c=g(a);for(let e=o;e<=s;e++)for(let t=i;t<=u;t++)c[e][t]=!0;l.working=c,l.last=[r,n],O(m(c)),es(c)}else if("paint-add"===l.mode){let e=r*a+n;l.visited.has(e)||(l.visited.add(e),l.working[r][n]=!0,l.last=[r,n],O(e=>p([...e],[r,n])),es(l.working.map(e=>e.slice())))}else{let e=r*a+n;if(!l.visited.has(e)&&(l.visited.add(e),l.working[r][n])){var o;l.working[r][n]=!1,l.last=[r,n],O(e=>v(e,[r,n])),es(l.working.map(e=>e.slice())),er&&(o=[r,n],er[0]===o[0]&&er[1]===o[1])&&O(e=>{let t=v(e,[r,n]);return ei(t.length?t[t.length-1]:void 0),t})}}},[a,es,ec,er,ei]),eg=(0,l.useCallback)(()=>{var e;if(!$.current)return;let t=$.current;("rect"===t.mode||"paint-add"===t.mode)&&ei(null!=(e=t.last)?e:t.start),$.current=null,X.current=!1},[ei]),eb=(0,l.useCallback)(e=>{eg();try{e.currentTarget.releasePointerCapture(e.pointerId)}catch(e){}},[eg]),eh=(0,l.useCallback)(()=>{X.current&&eg()},[eg]),ep=(0,l.useCallback)(e=>{let t=k(en,er);0!==t.length&&G(r=>{let n=r.map(e=>e.slice());for(let[r,l]of t)el(r,l)||(n[r][l]=e>0?e:0);return n})},[en,er,el]),ev=(0,l.useCallback)((e,t)=>{if(t<1||t>a)return;let r=k(en,er);r.length&&e(e=>{let n=e.map(e=>e.map(e=>e.slice()));for(let[e,l]of r)el(e,l)||(n[e][l][t]=+!n[e][l][t]);return n})},[en,er,el,a]),em=(0,l.useCallback)(e=>{let t=k(en,er);t.length&&e(e=>{let r=e.map(e=>e.map(e=>e.slice()));for(let[e,n]of t)el(e,n)||r[e][n].fill(0);return r})},[en,er,el]),ex=(0,l.useCallback)((e,t)=>{let r=er;r||(r=b(en)?m(en)[0]:[0,0]);let n=u({row:r[0],col:r[1]},e,t,a),l=[n.row,n.col];ei(l),es(function(e,t,r){let n=g(e);return n[t][r]=!0,n}(a,l[0],l[1])),O([l])},[er,en,a,ei,es]),ew=(0,l.useCallback)(e=>{let t=e.key;if("Escape"===t){e.preventDefault(),es(g(a)),ei(void 0),O([]);return}if("ArrowUp"===t||"ArrowDown"===t||"ArrowLeft"===t||"ArrowRight"===t){e.preventDefault(),"ArrowUp"===t&&ex(-1,0),"ArrowDown"===t&&ex(1,0),"ArrowLeft"===t&&ex(0,-1),"ArrowRight"===t&&ex(0,1);return}if("Backspace"===t||"Delete"===t||"0"===t){e.preventDefault(),"center"===j?em(Q):"corner"===j?em(J):ep(0);return}if(/^[1-9]$/.test(t)){let r=parseInt(t,10);r>=1&&r<=Math.min(9,a)&&(e.preventDefault(),"center"===j?ev(Q,r):"corner"===j?ev(J,r):ep(r))}},[es,a,ei,ex,j,em,ep,ev]);return(0,l.useEffect)(()=>{U.current&&(b(en)||er)&&document.activeElement!==U.current&&U.current.focus()},[j,en,er]),(0,n.jsx)("div",{ref:U,tabIndex:0,onKeyDown:ew,className:"outline-none focus:outline-none",children:(0,n.jsx)("table",{role:"grid","aria-rowcount":a,"aria-colcount":a,children:(0,n.jsx)("tbody",{ref:V,className:s("border-2 border-foreground",o),onPointerDown:ed,onPointerMove:ef,onPointerUp:eb,onPointerLeave:eh,...R,children:Array.from({length:a}).map((e,t)=>(0,n.jsx)("tr",{role:"row",children:Array.from({length:a}).map((e,r)=>{var l,o,g,b,h,p,v,m;let x=t>0&&ea(u({row:t,col:r},-1,0,a).row,u({row:t,col:r},-1,0,a).col),w=r<a-1&&ea(u({row:t,col:r},0,1,a).row,u({row:t,col:r},0,1,a).col),k=t<a-1&&ea(u({row:t,col:r},1,0,a).row,u({row:t,col:r},1,0,a).col),y=r>0&&ea(u({row:t,col:r},0,-1,a).row,u({row:t,col:r},0,-1,a).col),C=r>0&&t>0&&!ea(t-1,r-1)&&x&&y,j=r<a-1&&t>0&&!ea(t-1,r+1)&&x&&w,N=r>0&&t<a-1&&!ea(t+1,r-1)&&k&&y,A=r<a-1&&t<a-1&&!ea(t+1,r+1)&&k&&w,M=ea(t,r),z=null!=(p=null==i||null==(l=i[t])?void 0:l[r])?p:0,S=null!=(v=null==q||null==(o=q[t])?void 0:o[r])?v:0,_=z>0?z:S>0?S:"",D=z||S||null==H||null==(g=H[t])?void 0:g[r],E=z||S||null==Y||null==(b=Y[t])?void 0:b[r],P=Math.min(9,a),R=[],I=[];if(D)for(let e=1;e<=P;e++)D[e]&&R.push(e);if(E)for(let e=1;e<=P;e++)E[e]&&I.push(e);let T=R.length>0?c.slice(0,8):c,K=null!=(m=null==W||null==(h=W[t])?void 0:h[r])?m:[],B=K.includes("black");return(0,n.jsx)("td",{role:"gridcell",className:eo(t,r),children:(0,n.jsxs)("div",{"aria-selected":M,"aria-readonly":el(t,r)||void 0,className:s("relative flex size-full cursor-pointer items-center justify-center text-2xl select-none","[--sel:theme(colors.blue.300)]",el(t,r)?"text-foreground":"text-blue-700 font-semibold",B&&"text-white"),children:[K.length>0&&(0,n.jsx)("div",{className:"absolute inset-0 overflow-hidden flex pointer-events-none",children:K.map((e,t)=>(0,n.jsx)("div",{className:s("h-full flex-1",f[e])},t))}),M&&!y&&(0,n.jsx)("span",{className:"pointer-events-none absolute top-0 bottom-0 left-0 w-[4px]",style:{background:"var(--sel)"}}),M&&!w&&(0,n.jsx)("span",{className:"pointer-events-none absolute top-0 right-0 bottom-0 w-[4px]",style:{background:"var(--sel)"}}),M&&!x&&(0,n.jsx)("span",{className:"pointer-events-none absolute top-0 right-0 left-0 h-[4px]",style:{background:"var(--sel)"}}),M&&!k&&(0,n.jsx)("span",{className:"pointer-events-none absolute right-0 bottom-0 left-0 h-[4px]",style:{background:"var(--sel)"}}),M&&C&&(0,n.jsx)("span",{className:"absolute top-0 left-0 size-[4px] rounded-br-xs bg-blue-300"}),M&&j&&(0,n.jsx)("span",{className:"absolute top-0 right-0 size-[4px] rounded-bl-xs bg-blue-300"}),M&&N&&(0,n.jsx)("span",{className:"absolute bottom-0 left-0 size-[4px] rounded-tr-xs bg-blue-300"}),M&&A&&(0,n.jsx)("span",{className:"absolute right-0 bottom-0 size-[4px] rounded-tl-xs bg-blue-300"}),""!==_&&(0,n.jsx)("span",{className:"absolute",children:_}),""===_&&I.length>0&&(0,n.jsx)(n.Fragment,{children:I.slice(0,9).map((e,t)=>{let r=T[t];return r?(0,n.jsx)("span",{className:s(d[r],"text-xs leading-none font-semibold tracking-tight"),children:e},"".concat(e,"-").concat(t)):null})}),""===_&&R.length>0&&(0,n.jsx)("span",{className:"absolute text-xs leading-none font-semibold tracking-tight",children:R.join("")})]})},r)})},t))})})})}),C=l.memo(y);var j=r(48),N=r(3101);let A=(0,N.F)("\n    inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap\n    transition-[color,box-shadow] outline-none\n    hover:bg-muted hover:text-muted-foreground\n    focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n    disabled:pointer-events-none disabled:opacity-50\n    aria-invalid:border-destructive aria-invalid:ring-destructive/20\n    data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\n    dark:aria-invalid:ring-destructive/40\n    [&_svg]:pointer-events-none [&_svg]:shrink-0\n    [&_svg:not([class*='size-'])]:size-4\n  ",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 min-w-9 px-2",sm:"h-8 min-w-8 px-1.5",lg:"h-10 min-w-10 px-2.5"}},defaultVariants:{variant:"default",size:"default"}});function M(e){let{className:t,variant:r,size:l,...a}=e;return(0,n.jsx)(j.b,{"data-slot":"toggle",className:s(A({variant:r,size:l,className:t})),...a})}var z=r(8514),S=r(2794),_=r(9295),D=r(6673);let E=(0,N.F)("\n    inline-flex shrink-0 items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap\n    transition-all outline-none\n    focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n    disabled:pointer-events-none disabled:opacity-50\n    aria-invalid:border-destructive aria-invalid:ring-destructive/20\n    dark:aria-invalid:ring-destructive/40\n    [&_svg]:pointer-events-none [&_svg]:shrink-0\n    [&_svg:not([class*='size-'])]:size-4\n  ",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"\n          bg-destructive text-white shadow-xs\n          hover:bg-destructive/90\n          focus-visible:ring-destructive/20\n          dark:bg-destructive/60 dark:focus-visible:ring-destructive/40\n        ",outline:"\n          border bg-background shadow-xs\n          hover:bg-accent hover:text-accent-foreground\n          dark:border-input dark:bg-input/30 dark:hover:bg-input/50\n        ",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 gap-1.5 rounded-md px-3 has-[>svg]:px-2.5",lg:"has-[>svg ]:px-4 h-10 rounded-md px-6",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function P(e){let{className:t,variant:r,size:l,asChild:a=!1,...o}=e,i=a?D.DX:"button";return(0,n.jsx)(i,{"data-slot":"button",className:s(E({variant:r,size:l,className:t})),...o})}function R(){let[e,t]=(0,l.useState)(),[r,a]=(0,l.useState)(Array.from({length:9},()=>Array(9).fill(!1))),[o,s]=(0,l.useState)(null),i=(0,l.useRef)(null);return(0,n.jsxs)("div",{className:"space-y-4 p-8",children:[(0,n.jsx)(C,{ref:i,presetGrid:[[0,0,0,1,0,2,0,0,0],[0,6,0,0,0,0,0,7,0],[0,0,8,0,0,0,9,0,0],[4,5,0,0,0,0,0,0,3],[0,0,0,0,0,7,0,0,0],[2,0,0,0,8,0,0,0,1],[0,0,9,0,0,0,8,0,5],[0,7,0,0,0,0,0,6,0],[0,0,0,3,0,4,0,0,0]],pencilMode:o,currentCell:e,selectedCells:r,onSelectionChange:a,onCurrentCellChange:t,onCellSelect:e=>{let{row:t,col:r}=e;console.log("Clicked:",t,r)}}),(0,n.jsxs)("div",{className:"flex gap-2 rounded-md border p-2",children:[(0,n.jsx)(M,{variant:"outline","aria-label":"Toggle Center Notes Mode",pressed:"center"===o,onPressedChange:e=>s(e?"center":null),children:(0,n.jsx)(z.A,{})}),(0,n.jsx)(M,{variant:"outline","aria-label":"Toggle Corner Notes Mode",pressed:"corner"===o,onPressedChange:e=>s(e?"corner":null),children:(0,n.jsx)(S.A,{})})]}),(0,n.jsxs)("div",{className:"grid w-fit grid-cols-3 gap-1 rounded-md border p-2",children:[["red","orange","yellow","green","cyan","blue","violet","pink","transparent"].map(e=>(0,n.jsx)(P,{variant:"outline","aria-label":"Apply ".concat(e," color to selection"),onClick:()=>{var t;return null==(t=i.current)?void 0:t.annotateColor(e)},title:"Toggle ".concat(e," stripe"),children:(0,n.jsx)("span",{"aria-hidden":!0,className:"size-5 rounded-xs border border-black/10 ".concat(f[e])})},e)),(0,n.jsx)(P,{variant:"outline","aria-label":"Clear color from selection",onClick:()=>{var e;return null==(e=i.current)?void 0:e.annotateClear()},title:"Clear all stripes",children:(0,n.jsx)(_.A,{})})]})]})}},7767:(e,t,r)=>{Promise.resolve().then(r.bind(r,1941))}},e=>{e.O(0,[960,441,255,358],()=>e(e.s=7767)),_N_E=e.O()}]);