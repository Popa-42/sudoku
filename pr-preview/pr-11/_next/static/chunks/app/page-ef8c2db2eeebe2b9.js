(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6867:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ec});var n=r(5155),l=r(2115),a=r(2821),o=r(5889);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,a.$)(t))}let i=(e,t,r)=>Math.min(r,Math.max(t,e));function c(e,t,r,n){let l=null!=n?n-1:1/0;return{row:i(e.row+t,0,l),col:i(e.col+r,0,l)}}let d=["tl","tr","bl","br","tc","rc","bc","lc","cc"],u={tl:"absolute top-1 left-1 translate-x-0.5 translate-y-0.5",tr:"absolute top-1 right-1 -translate-x-0.5 translate-y-0.5",bl:"absolute bottom-1 left-1 translate-x-0.5 -translate-y-0.5",br:"absolute bottom-1 right-1 -translate-x-0.5 -translate-y-0.5",tc:"absolute top-1 left-1/2 -translate-x-1/2 translate-y-0.5",rc:"absolute right-1 top-1/2 -translate-y-1/2 -translate-x-0.5",bc:"absolute bottom-1 left-1/2 -translate-x-1/2 -translate-y-0.5",lc:"absolute left-1 top-1/2 -translate-y-1/2 translate-x-0.5",cc:"absolute inset-1 flex items-center justify-center"},f={red:"bg-red-200 dark:bg-red-500/40",orange:"bg-orange-200 dark:bg-orange-500/40",yellow:"bg-yellow-200 dark:bg-yellow-500/40",green:"bg-green-200 dark:bg-green-500/40",cyan:"bg-cyan-200 dark:bg-cyan-500/40",blue:"bg-blue-200 dark:bg-blue-500/40",violet:"bg-violet-200 dark:bg-violet-500/40",pink:"bg-pink-200 dark:bg-pink-500/40",transparent:"bg-transparent"};function g(e){return Array.from({length:e},()=>Array(e).fill(!1))}function p(e){return e.some(e=>e.some(Boolean))}function h(e,t){return e.findIndex(e=>{let[r,n]=e;return r===t[0]&&n===t[1]})}function m(e,t){return -1===h(e,t)&&e.push(t),e}function x(e,t){return e.filter(e=>{let[r,n]=e;return r!==t[0]||n!==t[1]})}function b(e){let t=[];for(let r=0;r<e.length;r++)for(let n=0;n<e[r].length;n++)e[r][n]&&t.push([r,n]);return t}function v(e){return Array.from({length:e},()=>Array(e).fill(0))}function y(e){return Array.from({length:e},()=>Array.from({length:e},()=>Array(e+1).fill(0)))}function w(e,t){return p(e)?b(e):t?[t]:[]}let j="SG1|",k={red:"r",orange:"o",yellow:"y",green:"g",blue:"b",cyan:"c",violet:"v",pink:"p",transparent:"t"},C=Object.fromEntries(Object.entries(k).map(e=>{let[t,r]=e;return[r,t]}));function N(e){return e.toString(36)}function S(e){return parseInt(e,36)}function A(e,t){let r=Array(t*t),n=0;for(let o=0;o<t;o++)for(let s=0;s<t;s++){var l,a;let t=null!=(a=null==e||null==(l=e[o])?void 0:l[s])?a:0;if(t<0||t>=36)throw Error("Value out of encodable range (0..35)");r[n++]=N(t)}return r.join("")}function z(e,t){let r=Math.max(1,Math.max(0,Math.pow(2,t)-1).toString(36).length),n=Array(t*t),l=0;for(let o=0;o<t;o++)for(let s=0;s<t;s++){var a;let i=0,c=null==e||null==(a=e[o])?void 0:a[s];if(c)for(let e=1;e<=t;e++)c[e]&&(i|=1<<e-1);n[l++]=i.toString(36).padStart(r,"0")}return{width:r,data:n.join("")}}function M(e,t){if(!e||e.length<1)throw Error("Corrupt state: empty mask payload");let r=S(e[0]);if(r<1||r>10)throw Error("Corrupt state: invalid mask width");let n=e.slice(1),l=t*t*r;if(n.length!==l)throw Error("Corrupt state: mask body length mismatch");let a=y(t),o=0;for(let e=0;e<t;e++)for(let l=0;l<t;l++){let s=n.slice(o,o+r);o+=r;let i=parseInt(s,36)||0;for(let r=1;r<=t;r++)a[e][l][r]=i>>r-1&1?1:0}return a}let E=l.forwardRef(function(e,t){var r;let{size:a=9,className:o,presetGrid:i,editedGrid:E,pencilGrid:I,pencilMode:P=null,currentCell:R,selectedCells:_,onCellSelect:D,onSelectionChange:U,onCurrentCellChange:T,box:G,regions:L,cellClassName:O,dividerClassName:F="border-foreground dark:border-muted",...B}=e;if(!Number.isInteger(a)||a<=0)throw Error("Size must be a positive integer.");if(L&&(L.length!==a||L.some(e=>e.length!==a)))throw Error('Invalid "regions": expected a size\xd7size matrix.');let K=(0,l.useMemo)(()=>g(a),[a]),[V,W]=(0,l.useState)(void 0),[X,Y]=(0,l.useState)(K),[$,q]=(0,l.useState)([]),H=(0,l.useRef)(null),J=(0,l.useRef)(null),Q=(0,l.useRef)(!1),Z=(0,l.useRef)(null),[ee,et]=(0,l.useState)(()=>v(a)),[er,en]=(0,l.useState)(()=>y(a)),[el,ea]=(0,l.useState)(()=>y(a)),[eo,es]=(0,l.useState)(()=>Array.from({length:a},()=>Array.from({length:a},()=>[])));(0,l.useEffect)(()=>{Y(K),W(void 0),q([]),et(v(a)),en(y(a)),ea(y(a)),es(Array.from({length:a},()=>Array.from({length:a},()=>[])))},[a,K]);let ei=(0,l.useMemo)(()=>null!=G?G:function(e){if(9===e)return{rows:3,cols:3};let t=Math.floor(Math.sqrt(e));return t>1&&e%t==0?{rows:t,cols:e/t}:{rows:e,cols:1}}(a),[G,a]),ec=(0,l.useMemo)(()=>{if(L)return(e,t)=>L[e][t];let e=ei.cols,t=ei.rows,r=Math.ceil(a/e);return(n,l)=>Math.floor(n/t)*r+Math.floor(l/e)},[L,ei,a]),ed=null!=R?R:V,eu=!(r=null!=_?_:X)||r.length!==a||r.some(e=>e.length!==a)?g(a):r,ef=(0,l.useCallback)((e,t)=>{var r,n;return(null!=(n=null==i||null==(r=i[e])?void 0:r[t])?n:0)>0},[i]);(0,l.useEffect)(()=>{p(eu)||(R||W(void 0),q([]),null==T||T(void 0))},[eu,R,T]);let eg=(0,l.useCallback)((e,t)=>{var r;return!!(null==eu||null==(r=eu[e])?void 0:r[t])},[eu]),ep=(0,l.useCallback)((e,t)=>{let r=["size-10","border","border-foreground","dark:border-muted","text-center","select-none","cursor-pointer"];O&&r.push(O);let n=[];if(L){let r=ec(e,t),l=0===e||ec(e-1,t)!==r,o=0===t||ec(e,t-1)!==r,s=t===a-1||ec(e,t+1)!==r,i=e===a-1||ec(e+1,t)!==r;l&&n.push("border-t-2",F),o&&n.push("border-l-2",F),s&&n.push("border-r-2",F),i&&n.push("border-b-2",F)}else{let r=0===e||e%ei.rows==0,l=0===t||t%ei.cols==0,o=t===a-1||(t+1)%ei.cols==0,s=e===a-1||(e+1)%ei.rows==0;r&&n.push("border-t-2",F),l&&n.push("border-l-2",F),o&&n.push("border-r-2",F),s&&n.push("border-b-2",F)}return s(r.join(" "),n.join(" "))},[L,ec,a,ei,F,O]),eh=(0,l.useCallback)(e=>{_||Y(e),null==U||U(e)},[_,U]),em=(0,l.useCallback)(e=>{R||W(e),null==T||T(e)},[R,T]);(0,l.useImperativeHandle)(t,()=>({annotateColor:e=>{let t=w(eu,ed);t.length&&es(r=>{let n=r.map(e=>e.map(e=>e.slice()));for(let[r,l]of t){let t=n[r][l],a=t.indexOf(e);a>=0?t.splice(a,1):t.push(e)}return n})},annotateClear:()=>{let e=w(eu,ed);e.length&&es(t=>{let r=t.map(e=>e.map(e=>e.slice()));for(let[t,n]of e)r[t][n]=[];return r})},setDigit:e=>{let t=w(eu,ed);t.length&&et(r=>{let n=r.map(e=>e.slice());for(let[r,l]of t)ef(r,l)||(n[r][l]=e>0?e:0);return n})},toggleCenterNote:e=>{if(e<1||e>a)return;let t=w(eu,ed);t.length&&en(r=>{let n=r.map(e=>e.map(e=>e.slice()));for(let[r,l]of t)ef(r,l)||(n[r][l][e]=+!n[r][l][e]);return n})},toggleCornerNote:e=>{if(e<1||e>a)return;let t=w(eu,ed);t.length&&ea(r=>{let n=r.map(e=>e.map(e=>e.slice()));for(let[r,l]of t)ef(r,l)||(n[r][l][e]=+!n[r][l][e]);return n})},clearCenterNotes:()=>{let e=w(eu,ed);e.length&&en(t=>{let r=t.map(e=>e.map(e=>e.slice()));for(let[t,n]of e)ef(t,n)||r[t][n].fill(0);return r})},clearCornerNotes:()=>{let e=w(eu,ed);e.length&&ea(t=>{let r=t.map(e=>e.map(e=>e.slice()));for(let[t,n]of e)ef(t,n)||r[t][n].fill(0);return r})},exportState:()=>{let e=N(a),t=A(null!=i?i:v(a),a),r=A(ee,a),n=z(er,a),l=z(el,a),o=function(e,t){let r="";for(let a=0;a<t;a++)for(let o=0;o<t;o++){var n,l;let t=(null!=(l=null==e||null==(n=e[a])?void 0:n[o])?l:[]).map(e=>{var t;return null!=(t=k[e])?t:""}).join("");if(t.length>=36)throw Error("Too many color stripes in a cell (max 35)");r+=N(t.length)+t}return r}(eo,a),s=N(n.width)+n.data,c=N(l.width)+l.data;return[j.slice(0,-1),e,t,r,s,c,o,""].join("|")},importState:e=>{if(!e||!e.startsWith(j))throw Error("Invalid state payload");let t=e.split("|");if(t.length<7)throw Error("Corrupt state: missing segments");let r=S(t[1]);if(r!==a)throw Error("State size ".concat(r," does not match grid size ").concat(a));let n=t[3],l=t[4],o=t[5],s=t[6],i=function(e,t){let r=t*t;if(e.length!==r)throw Error("Corrupt state: number grid length mismatch");let n=v(t);for(let l=0;l<r;l++){let r=Math.floor(l/t),a=l%t;n[r][a]=S(e[l])||0}return n}(n,a),c=M(l,a),d=M(o,a),u=function(e,t){let r=Array.from({length:t},()=>Array.from({length:t},()=>[])),n=0;for(let l=0;l<t;l++)for(let a=0;a<t;a++){if(n>=e.length)throw Error("Corrupt state: truncated colors segment");let t=S(e[n]);n+=1;let o=e.slice(n,n+t);n+=t;let s=[];for(let e=0;e<o.length;e++){let t=C[o[e]];t&&s.push(t)}r[l][a]=s}return r}(s,a);et(i),en(c),ea(d),es(u)}}),[eu,ed,ef,a,i,ee,er,el,eo]);let ex=(0,l.useCallback)((e,t)=>Math.max(0,Math.min(t-1,e)),[]),eb=(0,l.useCallback)(e=>{let t=J.current;if(!t)return;let r=t.getBoundingClientRect(),n=e.clientX-r.left,l=e.clientY-r.top;if(n<0||l<0||n>r.width||l>r.height)return;let o=ex(Math.floor(n/r.width*a),a);return[ex(Math.floor(l/r.height*a),a),o]},[a,ex]),ev=(0,l.useCallback)(e=>{var t,r,n;let l=eb(e);if(!l)return;null==(t=H.current)||t.focus();let[o,s]=l,i=e.ctrlKey||e.metaKey,c=e.shiftKey,d=i?eu.map(e=>e.slice()):g(a),u=d.map(e=>e.slice()),f=i?d[o][s]?"paint-erase":"paint-add":c?"rect":"paint-add",p={mode:f,start:[o,s],base:d,working:u,visited:new Set([o*a+s]),last:[o,s]};if("rect"===f)(u=g(a))[o][s]=!0,p.working=u,q([[o,s]]),eh(u),em([o,s]);else if("paint-add"===f)u[o][s]=!0,p.working=u,q(i?e=>m([...e],[o,s]):[[o,s]]),eh(u.map(e=>e.slice())),em([o,s]);else{u[o][s]=!1,p.working=u,q(e=>x(e,[o,s])),eh(u.map(e=>e.slice()));let e=h($,[o,s]),t=$.filter(e=>{let[t,r]=e;return t!==o||r!==s});em(e>0?$[e-1]:t[t.length-1])}Z.current=p,Q.current=!0,null==(r=(n=e.currentTarget).setPointerCapture)||r.call(n,e.pointerId)},[eu,a,eh,em,eb,$]),ey=(0,l.useCallback)(e=>{if(!Z.current)return;let t=eb(e);if(!t)return;let[r,n]=t,l=Z.current;if("rect"===l.mode){let[e,t]=l.start,o=Math.min(e,r),s=Math.max(e,r),i=Math.min(t,n),c=Math.max(t,n),d=g(a);for(let e=o;e<=s;e++)for(let t=i;t<=c;t++)d[e][t]=!0;l.working=d,l.last=[r,n],q(b(d)),eh(d)}else if("paint-add"===l.mode){let e=r*a+n;l.visited.has(e)||(l.visited.add(e),l.working[r][n]=!0,l.last=[r,n],q(e=>m([...e],[r,n])),eh(l.working.map(e=>e.slice())))}else{let e=r*a+n;if(!l.visited.has(e)&&(l.visited.add(e),l.working[r][n])){var o;l.working[r][n]=!1,l.last=[r,n],q(e=>x(e,[r,n])),eh(l.working.map(e=>e.slice())),ed&&(o=[r,n],ed[0]===o[0]&&ed[1]===o[1])&&q(e=>{let t=x(e,[r,n]);return em(t.length?t[t.length-1]:void 0),t})}}},[a,eh,eb,ed,em]),ew=(0,l.useCallback)(()=>{var e;if(!Z.current)return;let t=Z.current;("rect"===t.mode||"paint-add"===t.mode)&&em(null!=(e=t.last)?e:t.start),Z.current=null,Q.current=!1},[em]),ej=(0,l.useCallback)(e=>{ew();try{e.currentTarget.releasePointerCapture(e.pointerId)}catch(e){}},[ew]),ek=(0,l.useCallback)(()=>{Q.current&&ew()},[ew]),eC=(0,l.useCallback)(e=>{let t=w(eu,ed);0!==t.length&&et(r=>{let n=r.map(e=>e.slice());for(let[r,l]of t)ef(r,l)||(n[r][l]=e>0?e:0);return n})},[eu,ed,ef]),eN=(0,l.useCallback)((e,t)=>{if(t<1||t>a)return;let r=w(eu,ed);r.length&&e(e=>{let n=e.map(e=>e.map(e=>e.slice()));for(let[e,l]of r)ef(e,l)||(n[e][l][t]=+!n[e][l][t]);return n})},[eu,ed,ef,a]),eS=(0,l.useCallback)(e=>{let t=w(eu,ed);t.length&&e(e=>{let r=e.map(e=>e.map(e=>e.slice()));for(let[e,n]of t)ef(e,n)||r[e][n].fill(0);return r})},[eu,ed,ef]),eA=(0,l.useCallback)((e,t)=>{let r=ed;r||(r=p(eu)?b(eu)[0]:[0,0]);let n=c({row:r[0],col:r[1]},e,t,a),l=[n.row,n.col];em(l),eh(function(e,t,r){let n=g(e);return n[t][r]=!0,n}(a,l[0],l[1])),q([l])},[ed,eu,a,em,eh]),ez=(0,l.useCallback)(e=>{let t=e.key;if("Escape"===t){e.preventDefault(),eh(g(a)),em(void 0),q([]);return}if("ArrowUp"===t||"ArrowDown"===t||"ArrowLeft"===t||"ArrowRight"===t){e.preventDefault(),"ArrowUp"===t&&eA(-1,0),"ArrowDown"===t&&eA(1,0),"ArrowLeft"===t&&eA(0,-1),"ArrowRight"===t&&eA(0,1);return}if("Backspace"===t||"Delete"===t||"0"===t){e.preventDefault(),"center"===P?eS(en):"corner"===P?eS(ea):eC(0);return}if(/^[1-9]$/.test(t)){let r=parseInt(t,10);r>=1&&r<=Math.min(9,a)&&(e.preventDefault(),"center"===P?eN(en,r):"corner"===P?eN(ea,r):eC(r))}},[eh,a,em,eA,P,eS,eC,eN]);return(0,l.useEffect)(()=>{H.current&&(p(eu)||ed)&&document.activeElement!==H.current&&H.current.focus()},[P,eu,ed]),(0,n.jsx)("div",{ref:H,tabIndex:0,onKeyDown:ez,className:"outline-none focus:outline-none",children:(0,n.jsx)("table",{role:"grid","aria-rowcount":a,"aria-colcount":a,children:(0,n.jsx)("tbody",{ref:J,className:o,onPointerDown:ev,onPointerMove:ey,onPointerUp:ej,onPointerLeave:ek,...B,children:Array.from({length:a}).map((e,t)=>(0,n.jsx)("tr",{role:"row",children:Array.from({length:a}).map((e,r)=>{var l,o,g,p,h,m,x,b;let v=t>0&&eg(c({row:t,col:r},-1,0,a).row,c({row:t,col:r},-1,0,a).col),y=r<a-1&&eg(c({row:t,col:r},0,1,a).row,c({row:t,col:r},0,1,a).col),w=t<a-1&&eg(c({row:t,col:r},1,0,a).row,c({row:t,col:r},1,0,a).col),j=r>0&&eg(c({row:t,col:r},0,-1,a).row,c({row:t,col:r},0,-1,a).col),k=r>0&&t>0&&!eg(t-1,r-1)&&v&&j,C=r<a-1&&t>0&&!eg(t-1,r+1)&&v&&y,N=r>0&&t<a-1&&!eg(t+1,r-1)&&w&&j,S=r<a-1&&t<a-1&&!eg(t+1,r+1)&&w&&y,A=eg(t,r),z=null!=(m=null==i||null==(l=i[t])?void 0:l[r])?m:0,M=null!=(x=null==ee||null==(o=ee[t])?void 0:o[r])?x:0,E=z>0?z:M>0?M:"",I=z||M||null==er||null==(g=er[t])?void 0:g[r],P=z||M||null==el||null==(p=el[t])?void 0:p[r],R=Math.min(9,a),_=[],D=[];if(I)for(let e=1;e<=R;e++)I[e]&&_.push(e);if(P)for(let e=1;e<=R;e++)P[e]&&D.push(e);let U=_.length>0?d.slice(0,8):d,T=null!=(b=null==eo||null==(h=eo[t])?void 0:h[r])?b:[];return(0,n.jsx)("td",{role:"gridcell",className:ep(t,r),children:(0,n.jsxs)("div",{"aria-selected":A,"aria-readonly":ef(t,r)||void 0,className:s("relative flex size-full cursor-pointer items-center justify-center text-2xl select-none","[--sel:theme(colors.blue.300)] dark:[--sel:theme(colors.blue.800)]",ef(t,r)?"text-foreground":"text-blue-700 dark:text-blue-400 font-bold font-serif"),children:[T.length>0&&(0,n.jsx)("div",{className:"absolute inset-0 overflow-hidden flex pointer-events-none",children:T.map((e,t)=>(0,n.jsx)("div",{className:s("h-full flex-1",f[e])},t))}),A&&!j&&(0,n.jsx)("span",{className:"pointer-events-none absolute top-0 bottom-0 left-0 w-[4px]",style:{background:"var(--sel)"}}),A&&!y&&(0,n.jsx)("span",{className:"pointer-events-none absolute top-0 right-0 bottom-0 w-[4px]",style:{background:"var(--sel)"}}),A&&!v&&(0,n.jsx)("span",{className:"pointer-events-none absolute top-0 right-0 left-0 h-[4px]",style:{background:"var(--sel)"}}),A&&!w&&(0,n.jsx)("span",{className:"pointer-events-none absolute right-0 bottom-0 left-0 h-[4px]",style:{background:"var(--sel)"}}),A&&k&&(0,n.jsx)("span",{className:"absolute top-0 left-0 size-[4px] rounded-br-xs bg-(--sel)"}),A&&C&&(0,n.jsx)("span",{className:"absolute top-0 right-0 size-[4px] rounded-bl-xs bg-(--sel)"}),A&&N&&(0,n.jsx)("span",{className:"absolute bottom-0 left-0 size-[4px] rounded-tr-xs bg-(--sel)"}),A&&S&&(0,n.jsx)("span",{className:"absolute right-0 bottom-0 size-[4px] rounded-tl-xs bg-(--sel)"}),""!==E&&(0,n.jsx)("span",{className:"absolute",children:E}),""===E&&D.length>0&&(0,n.jsx)(n.Fragment,{children:D.slice(0,9).map((e,t)=>{let r=U[t];return r?(0,n.jsx)("span",{className:s(u[r],"text-xxs leading-none font-semibold tracking-tight"),children:e},"".concat(e,"-").concat(t)):null})}),""===E&&_.length>0&&(0,n.jsx)("span",{className:"absolute text-xs leading-none font-semibold tracking-tight",children:_.join("")})]})},r)})},t))})})})}),I=l.memo(E);var P=r(1887),R=r(3101);let _=(0,R.F)("\n    inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap\n    transition-[color,box-shadow] outline-none\n    hover:bg-muted hover:text-muted-foreground\n    focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n    disabled:pointer-events-none disabled:opacity-50\n    aria-invalid:border-destructive aria-invalid:ring-destructive/20\n    data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\n    dark:aria-invalid:ring-destructive/40\n    [&_svg]:pointer-events-none [&_svg]:shrink-0\n    [&_svg:not([class*='size-'])]:size-4\n  ",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 min-w-9 px-2",sm:"h-8 min-w-8 px-1.5",lg:"h-10 min-w-10 px-2.5"}},defaultVariants:{variant:"default",size:"default"}});function D(e){let{className:t,variant:r,size:l,...a}=e;return(0,n.jsx)(P.b,{"data-slot":"toggle",className:s(_({variant:r,size:l,className:t})),...a})}var U=r(8514),T=r(2794),G=r(5523),L=r(9295),O=r(5022),F=r(653),B=r(6701),K=r(2467);let V=(0,R.F)("\n    inline-flex shrink-0 items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap\n    transition-all outline-none\n    focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n    disabled:pointer-events-none disabled:opacity-50\n    aria-invalid:border-destructive aria-invalid:ring-destructive/20\n    dark:aria-invalid:ring-destructive/40\n    [&_svg]:pointer-events-none [&_svg]:shrink-0\n    [&_svg:not([class*='size-'])]:size-4\n  ",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"\n          bg-destructive text-white shadow-xs\n          hover:bg-destructive/90\n          focus-visible:ring-destructive/20\n          dark:bg-destructive/60 dark:focus-visible:ring-destructive/40\n        ",outline:"\n          border bg-background shadow-xs\n          hover:bg-accent hover:text-accent-foreground\n          dark:border-input dark:bg-input/30 dark:hover:bg-input/50\n        ",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 gap-1.5 rounded-md px-3 has-[>svg]:px-2.5",lg:"has-[>svg ]:px-4 h-10 rounded-md px-6",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function W(e){let{className:t,variant:r,size:l,asChild:a=!1,...o}=e,i=a?K.DX:"button";return(0,n.jsx)(i,{"data-slot":"button",className:s(V({variant:r,size:l,className:t})),...o})}var X=r(7268);function Y(e){let{className:t,orientation:r="horizontal",decorative:l=!0,...a}=e;return(0,n.jsx)(X.b,{"data-slot":"separator",decorative:l,orientation:r,className:s("\n          shrink-0 bg-border\n          data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full\n          data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\n        ",t),...a})}var $=r(8126),q=r(5229);function H(e){let{...t}=e;return(0,n.jsx)($.bL,{"data-slot":"dialog",...t})}function J(e){let{...t}=e;return(0,n.jsx)($.l9,{"data-slot":"dialog-trigger",...t})}function Q(e){let{...t}=e;return(0,n.jsx)($.ZL,{"data-slot":"dialog-portal",...t})}function Z(e){let{className:t,...r}=e;return(0,n.jsx)($.hJ,{"data-slot":"dialog-overlay",className:s("\n          fixed inset-0 z-50 bg-black/50\n          data-[state=closed]:animate-out data-[state=closed]:fade-out-0\n          data-[state=open]:animate-in data-[state=open]:fade-in-0\n        ",t),...r})}function ee(e){let{className:t,children:r,showCloseButton:l=!0,...a}=e;return(0,n.jsxs)(Q,{"data-slot":"dialog-portal",children:[(0,n.jsx)(Z,{}),(0,n.jsxs)($.UC,{"data-slot":"dialog-content",className:s("\n            fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%]\n            gap-4 rounded-lg border bg-background p-6 shadow-lg duration-200\n            data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95\n            data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95\n            sm:max-w-lg\n          ",t),...a,children:[r,l&&(0,n.jsxs)($.bm,{"data-slot":"dialog-close",className:"\n              absolute top-4 right-4 rounded-xs opacity-70 ring-offset-background transition-opacity\n              hover:opacity-100\n              focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:outline-hidden\n              disabled:pointer-events-none\n              data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\n              [&_svg]:pointer-events-none [&_svg]:shrink-0\n              [&_svg:not([class*='size-'])]:size-4\n            ",children:[(0,n.jsx)(q.A,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function et(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"dialog-header",className:s("flex flex-col gap-2 text-center sm:text-left",t),...r})}function er(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"dialog-footer",className:s("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function en(e){let{className:t,...r}=e;return(0,n.jsx)($.hE,{"data-slot":"dialog-title",className:s("text-lg leading-none font-semibold",t),...r})}function el(e){let{className:t,...r}=e;return(0,n.jsx)($.VY,{"data-slot":"dialog-description",className:s("text-sm text-muted-foreground",t),...r})}function ea(e){let{className:t,...r}=e;return(0,n.jsx)("textarea",{"data-slot":"textarea",className:s("\n          flex field-sizing-content min-h-16 w-full rounded-md border border-input bg-transparent px-3 py-2 text-base\n          shadow-xs transition-[color,box-shadow] outline-none\n          placeholder:text-muted-foreground\n          focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n          disabled:cursor-not-allowed disabled:opacity-50\n          aria-invalid:border-destructive aria-invalid:ring-destructive/20\n          md:text-sm\n          dark:bg-input/30 dark:aria-invalid:ring-destructive/40\n        ",t),...r})}var eo=r(489);function es(e){let{className:t,...r}=e;return(0,n.jsx)(eo.b,{"data-slot":"label",className:s("\n          flex items-center gap-2 text-sm leading-none font-medium select-none\n          group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50\n          peer-disabled:cursor-not-allowed peer-disabled:opacity-50\n        ",t),...r})}let ei={1:"tl",2:"tc",3:"tr",4:"lc",5:"cc",6:"rc",7:"bl",8:"bc",9:"br"};function ec(){let[e,t]=(0,l.useState)(),[r,a]=(0,l.useState)(Array.from({length:9},()=>Array(9).fill(!1))),[o,i]=(0,l.useState)(null),c=(0,l.useRef)(null);(0,l.useEffect)(()=>{z()},[]);let d=["red","orange","yellow","green","cyan","blue","violet","pink","transparent"],g=[1,2,3,4,5,6,7,8,9,0],p="color"===o,h="center"===o,m="corner"===o,x=async()=>{try{var e;let t=null==(e=c.current)?void 0:e.exportState();if(!t)return;R(t),E(!0)}catch(e){console.error(e)}},b=e=>{try{var t;if(!(null==e?void 0:e.startsWith("SG1|")))throw Error("Invalid payload");null==(t=c.current)||t.importState(e)}catch(e){console.error(e),alert(e.message||"Failed to import")}},v=async()=>{try{let e=await navigator.clipboard.readText();b(e)}catch(t){let e=prompt("Paste your SG1 payload here:");e&&b(e)}},[y,w]=(0,l.useState)(!1),[j,k]=(0,l.useState)(""),[C,N]=(0,l.useState)(null),S=(0,l.useRef)(null),A=async e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&(k((await r.text()).trim()),N(null),e.target.value="")},z=()=>{try{let e=new URL(window.location.href),t=e.searchParams.get("state")||e.hash.replace(/^#state=/,"");if(!t)return;b(decodeURIComponent(t))}catch(e){console.error(e)}},[M,E]=(0,l.useState)(!1),[P,R]=(0,l.useState)(""),_=async()=>{try{var e;await (null==(e=navigator.clipboard)?void 0:e.writeText(P))}catch(e){console.error(e),alert("Failed to copy")}};return(0,n.jsxs)("div",{className:"space-y-4 p-8",children:[(0,n.jsx)(I,{ref:c,presetGrid:[[0,0,0,1,0,2,0,0,0],[0,6,0,0,0,0,0,7,0],[0,0,8,0,0,0,9,0,0],[4,0,0,0,0,0,0,0,3],[0,5,0,0,0,7,0,0,0],[2,0,0,0,8,0,0,0,1],[0,0,9,0,0,0,8,0,5],[0,7,0,0,0,0,0,6,0],[0,0,0,3,0,4,0,0,0]],pencilMode:"center"===o?"center":"corner"===o?"corner":null,currentCell:e,selectedCells:r,onSelectionChange:a,onCurrentCellChange:t,onCellSelect:e=>{let{row:t,col:r}=e;console.log("Clicked:",t,r)}}),(0,n.jsxs)("div",{className:"flex w-fit flex-col gap-2 rounded-md border p-2",children:[(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(D,{variant:"outline","aria-label":"Toggle Center Notes Mode",pressed:"center"===o,onPressedChange:e=>i(e?"center":null),children:(0,n.jsx)(U.A,{})}),(0,n.jsx)(D,{variant:"outline","aria-label":"Toggle Corner Notes Mode",pressed:"corner"===o,onPressedChange:e=>i(e?"corner":null),children:(0,n.jsx)(T.A,{})}),(0,n.jsx)(D,{variant:"outline","aria-label":"Toggle Color Annotation Mode",pressed:"color"===o,onPressedChange:e=>i(e?"color":null),children:(0,n.jsx)(G.A,{})})]}),(0,n.jsx)(Y,{}),(0,n.jsx)("div",{className:"grid w-fit grid-cols-3 gap-1",children:Array.from({length:10}).map((e,t)=>{let r=p&&9===t,l=p?r?"Clear color from selection":"Apply ".concat(d[t]," color to selection"):h?"Toggle center note ".concat(g[t]):m?"Toggle corner note ".concat(g[t]):"Set digit ".concat(g[t]),a=p?r?"Clear all stripes":"Toggle ".concat(d[t]," stripe"):h||m?0===g[t]?"Clear notes":"".concat(h?"Center":"Corner"," note ").concat(g[t]):0===g[t]?"Clear value":"Place ".concat(g[t]),o=(()=>{if(0===g[t])return(0,n.jsx)(L.A,{});if(p){let e=d[t];return(0,n.jsx)("span",{"aria-hidden":!0,className:"size-4 rounded-xs border border-foreground/10 ".concat(f[e])})}let e=g[t];if(m){let t=ei[e];return(0,n.jsx)("span",{className:s(u[t],"font-serif text-xxs leading-none font-semibold tracking-tight"),children:e})}return(0,n.jsx)("span",{className:h?"text-xs font-serif":"text-base",children:e})})();return(0,n.jsx)(W,{size:"icon",variant:"outline","aria-label":l,title:a,className:s("relative",0===g[t]?"col-start-2":void 0),onClick:()=>(e=>{var t,r,n,l,a,o,s;if(p){if(e<d.length){let t=d[e];null==(r=c.current)||r.annotateColor(t)}else null==(n=c.current)||n.annotateClear();return}let i=g[e];return h?void(0===i?null==(l=c.current)||l.clearCenterNotes():null==(a=c.current)||a.toggleCenterNote(i)):m?void(0===i?null==(o=c.current)||o.clearCornerNotes():null==(s=c.current)||s.toggleCornerNote(i)):void(null==(t=c.current)||t.setDigit(i))})(t),children:o},t)})})]}),(0,n.jsxs)("div",{className:"flex w-fit items-center gap-1 rounded-md border p-2",children:[(0,n.jsx)(W,{size:"icon",variant:"outline","aria-label":"Share / export grid",title:"Share / export grid",onClick:x,children:(0,n.jsx)(O.A,{})}),(0,n.jsx)(W,{size:"icon",variant:"outline","aria-label":"Import from clipboard / paste",title:"Import from clipboard / paste",onClick:v,children:(0,n.jsx)(F.A,{})}),(0,n.jsxs)(H,{open:y,onOpenChange:w,children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)(W,{size:"icon",variant:"outline","aria-label":"Upload",title:"Upload",children:(0,n.jsx)(B.A,{})})}),(0,n.jsxs)(ee,{children:[(0,n.jsxs)(et,{children:[(0,n.jsx)(en,{children:"Upload sudoku state"}),(0,n.jsx)(el,{children:"Paste your SG1 payload or choose a file from your device."})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(es,{htmlFor:"sg1",children:"Sudoku state"}),(0,n.jsx)(ea,{id:"sg1",placeholder:"SG1|...",value:j,onChange:e=>k(e.target.value),"aria-invalid":!!C||void 0,spellCheck:!1}),C?(0,n.jsx)("p",{className:"text-sm text-destructive",children:C}):(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tip: payload should start with SG1|"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(W,{variant:"ghost",onClick:()=>{var e;return null==(e=S.current)?void 0:e.click()},type:"button",children:[(0,n.jsx)(B.A,{className:"mr-2"})," Choose file"]}),(0,n.jsx)("input",{ref:S,type:"file",accept:".txt,.sg1",className:"hidden",onChange:A})]})]}),(0,n.jsxs)(er,{children:[(0,n.jsx)(W,{variant:"outline",onClick:()=>w(!1),type:"button",children:"Cancel"}),(0,n.jsx)(W,{onClick:()=>{let e=j.trim();return e?e.startsWith("SG1|")?void(N(null),b(e),w(!1),k("")):void N("Invalid payload. Expected text starting with SG1|."):void N("Please paste a state or choose a file.")},type:"button",children:"Send"})]})]})]}),(0,n.jsx)(H,{open:M,onOpenChange:E,children:(0,n.jsxs)(ee,{children:[(0,n.jsxs)(et,{children:[(0,n.jsx)(en,{children:"Export sudoku state"}),(0,n.jsx)(el,{children:"Copy or download your SG1 payload."})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(es,{htmlFor:"sg1-out",children:"Sudoku state"}),(0,n.jsx)(ea,{id:"sg1-out",value:P,readOnly:!0,spellCheck:!1})]}),(0,n.jsxs)(er,{children:[(0,n.jsx)(W,{variant:"outline",onClick:()=>E(!1),type:"button",children:"Close"}),(0,n.jsx)(W,{variant:"secondary",onClick:_,type:"button",children:"Copy"}),(0,n.jsx)(W,{onClick:()=>{try{let e=new Blob([P],{type:"text/plain"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="sudoku.sg1.txt",document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(t)}catch(e){console.error(e)}},type:"button",children:"Download"})]})]})})]})]})}},7767:(e,t,r)=>{Promise.resolve().then(r.bind(r,6867))}},e=>{e.O(0,[132,441,255,358],()=>e(e.s=7767)),_N_E=e.O()}]);