(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5935:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>e_});var r=n(5155),l=n(2115),a=n(2821),o=n(5889);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.QP)((0,a.$)(t))}let i=(e,t,n)=>Math.min(n,Math.max(t,e));function d(e,t,n,r){let l=null!=r?r-1:1/0;return{row:i(e.row+t,0,l),col:i(e.col+n,0,l)}}let c=["tl","tr","bl","br","tc","rc","bc","lc","cc"],u={tl:"absolute top-1 left-1 translate-x-0.5 translate-y-0.5",tr:"absolute top-1 right-1 -translate-x-0.5 translate-y-0.5",bl:"absolute bottom-1 left-1 translate-x-0.5 -translate-y-0.5",br:"absolute bottom-1 right-1 -translate-x-0.5 -translate-y-0.5",tc:"absolute top-1 left-1/2 -translate-x-1/2 translate-y-0.5",rc:"absolute right-1 top-1/2 -translate-y-1/2 -translate-x-0.5",bc:"absolute bottom-1 left-1/2 -translate-x-1/2 -translate-y-0.5",lc:"absolute left-1 top-1/2 -translate-y-1/2 translate-x-0.5",cc:"absolute inset-1 flex items-center justify-center"},f={red:"bg-red-200 dark:bg-red-500/40",orange:"bg-orange-200 dark:bg-orange-500/40",yellow:"bg-yellow-200 dark:bg-yellow-500/40",green:"bg-green-200 dark:bg-green-500/40",cyan:"bg-cyan-200 dark:bg-cyan-500/40",blue:"bg-blue-200 dark:bg-blue-500/40",violet:"bg-violet-200 dark:bg-violet-500/40",pink:"bg-pink-200 dark:bg-pink-500/40",transparent:"bg-transparent"};function h(e){return Array.from({length:e},()=>Array(e).fill(!1))}function g(e){return e.some(e=>e.some(Boolean))}function p(e,t){return e.findIndex(e=>{let[n,r]=e;return n===t[0]&&r===t[1]})}function x(e,t){return -1===p(e,t)&&e.push(t),e}function m(e,t){return e.filter(e=>{let[n,r]=e;return n!==t[0]||r!==t[1]})}function b(e){let t=[];for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++)e[n][r]&&t.push([n,r]);return t}function v(e){return Array.from({length:e},()=>Array(e).fill(0))}function j(e){return Array.from({length:e},()=>Array.from({length:e},()=>Array(e+1).fill(0)))}let y="SG1|",k={red:"r",orange:"o",yellow:"y",green:"g",blue:"b",cyan:"c",violet:"v",pink:"p",transparent:"t"},w=Object.fromEntries(Object.entries(k).map(e=>{let[t,n]=e;return[n,t]})),C=e=>e.toString(36),N=e=>parseInt(e,36)||0,S={encodeNumGrid(e,t){let n=Array(t*t),r=0;for(let o=0;o<t;o++)for(let s=0;s<t;s++){var l,a;let t=null!=(a=null==e||null==(l=e[o])?void 0:l[s])?a:0;if(t<0||t>=36)throw Error("Value out of encodable range (0..35)");n[r++]=C(t)}return n.join("")},decodeNumGrid(e,t){let n=t*t;if(e.length!==n)throw Error("Corrupt state: number grid length mismatch");let r=v(t);for(let l=0;l<n;l++)r[Math.floor(l/t)][l%t]=N(e[l]);return r},encodeDigitCube(e,t){let n=Math.max(1,Math.max(0,Math.pow(2,t)-1).toString(36).length),r=[];for(let a=0;a<t;a++)for(let o=0;o<t;o++){var l;let s=0,i=null==e||null==(l=e[a])?void 0:l[o];if(i)for(let e=1;e<=t;e++)i[e]&&(s|=1<<e-1);r.push(s.toString(36).padStart(n,"0"))}return{width:n,data:r.join("")}},decodeDigitCube(e,t){if(!e)throw Error("Corrupt state: empty cube payload");let n=N(e[0]);if(n<1||n>10)throw Error("Corrupt state: invalid mask width");let r=e.slice(1);if(r.length!==t*t*n)throw Error("Corrupt state: mask length mismatch");let l=j(t),a=0;for(let e=0;e<t;e++)for(let o=0;o<t;o++){let s=r.slice(a,a+n);a+=n;let i=parseInt(s,36)||0;for(let n=1;n<=t;n++)l[e][o][n]=i>>n-1&1?1:0}return l},encodeColors(e,t){let n="";for(let a=0;a<t;a++)for(let o=0;o<t;o++){var r,l;let t=(null!=(l=null==e||null==(r=e[a])?void 0:r[o])?l:[]).map(e=>{var t;return null!=(t=k[e])?t:""}).join("");if(t.length>=36)throw Error("Too many color stripes in a cell (max 35)");n+=C(t.length)+t}return n},decodeColors(e,t){let n=Array.from({length:t},()=>Array.from({length:t},()=>[])),r=0;for(let l=0;l<t;l++)for(let a=0;a<t;a++){if(r>=e.length)throw Error("Corrupt state: truncated colors segment");let t=N(e[r++]),o=e.slice(r,r+=t),s=[];for(let e=0;e<o.length;e++){let t=w[o[e]];t&&s.push(t)}n[l][a]=s}return n},buildPayload(e){let{size:t,preset:n,user:r,center:l,corner:a,colors:o}=e,s=C(t),i=S.encodeNumGrid(n,t),d=S.encodeNumGrid(r,t),c=S.encodeDigitCube(l,t),u=S.encodeDigitCube(a,t),f=S.encodeColors(o,t);return["SG1",s,i,d,C(c.width)+c.data,C(u.width)+u.data,f,""].join("|")}};async function z(e){if("undefined"==typeof CompressionStream)return{bytes:e,compressed:!1};let t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength),n=new CompressionStream("gzip"),r=new Response(new Blob([t]).stream().pipeThrough(n)),l=new Uint8Array(await r.arrayBuffer());return l.length<e.length?{bytes:l,compressed:!0}:{bytes:e,compressed:!1}}async function M(e){var t,n;let r=JSON.stringify({t:null!=(t=e.title)?t:"",r:null!=(n=e.rules)?n:""}),l=new TextEncoder().encode(r),{bytes:a,compressed:o}=await z(l);return"M1".concat(String.fromCharCode(+!!o),"|").concat(btoa(String.fromCharCode(...a)).replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}async function A(e){var t,n,r;let l;if(!e||e.length<4||"M"!==e[0]||"1"!==e[1])return null;let a=e.charCodeAt(2)||0,o=null!=(t=e.split("|")[1])?t:"";if(!o)return null;try{let e=o.length%4?4-o.length%4:0,t=(o+"=".repeat(e)).replace(/-/g,"+").replace(/_/g,"/"),n=atob(t);l=new Uint8Array(n.length);for(let e=0;e<n.length;e++)l[e]=n.charCodeAt(e)}catch(e){return null}if((1&a)!=0){if("undefined"==typeof DecompressionStream)return null;try{let e=l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength),t=new DecompressionStream("gzip"),n=new Response(new Blob([e]).stream().pipeThrough(t)),r=await n.arrayBuffer();l=new Uint8Array(r)}catch(e){return null}}try{let e=new TextDecoder().decode(l),t=JSON.parse(e);return{title:null!=(n=t.t)?n:"",rules:null!=(r=t.r)?r:""}}catch(e){return null}}let E=l.forwardRef(function(e,t){var n;let{size:a=9,className:o,presetGrid:i,pencilMode:k=null,currentCell:w,selectedCells:C,onCellSelect:z,onSelectionChange:M,onCurrentCellChange:A,box:E,regions:D,cellClassName:R,dividerClassName:O="border-foreground dark:border-muted",editorialMode:_=!1,...T}=e;if(!Number.isInteger(a)||a<=0)throw Error("Size must be a positive integer.");if(D&&(D.length!==a||D.some(e=>e.length!==a)))throw Error('Invalid "regions": expected a size\xd7size matrix.');let P=(0,l.useMemo)(()=>h(a),[a]),[L,U]=(0,l.useState)(void 0),[I,F]=(0,l.useState)(P),[G,K]=(0,l.useState)([]),V=(0,l.useRef)(null),B=(0,l.useRef)(null),W=(0,l.useRef)(!1),X=(0,l.useRef)(null),[Z,Y]=(0,l.useState)(()=>null!=i?i:v(a)),[q,H]=(0,l.useState)(()=>v(a)),[J,$]=(0,l.useState)(()=>j(a)),[Q,ee]=(0,l.useState)(()=>j(a)),[et,en]=(0,l.useState)(()=>Array.from({length:a},()=>Array.from({length:a},()=>[]))),er=(0,l.useRef)([]),el=(0,l.useRef)(-1),ea=(0,l.useRef)(0),eo=(0,l.useCallback)(()=>S.buildPayload({size:a,preset:Z,user:q,center:J,corner:Q,colors:et}),[a,Z,q,J,Q,et]),es=(0,l.useCallback)(e=>{if(ea.current>0)return;let t=er.current,n=el.current;n>=0&&t[n]===e||(n<t.length-1&&t.splice(n+1),t.push(e),t.length>200&&t.splice(0,t.length-200),el.current=t.length-1)},[]);(0,l.useEffect)(()=>{es(eo())},[Z,q,J,Q,et]),(0,l.useEffect)(()=>{Y(null!=i?i:v(a))},[a,i]),(0,l.useEffect)(()=>{F(P),U(void 0),K([]),H(v(a)),$(j(a)),ee(j(a)),en(Array.from({length:a},()=>Array.from({length:a},()=>[]))),er.current=[],el.current=-1},[a,P]);let ei=(0,l.useMemo)(()=>null!=E?E:function(e){if(9===e)return{rows:3,cols:3};let t=Math.floor(Math.sqrt(e));return t>1&&e%t==0?{rows:t,cols:e/t}:{rows:e,cols:1}}(a),[E,a]),ed=(0,l.useMemo)(()=>{if(D)return(e,t)=>D[e][t];let e=ei.cols,t=ei.rows,n=Math.ceil(a/e);return(r,l)=>Math.floor(r/t)*n+Math.floor(l/e)},[D,ei,a]),ec=null!=w?w:L,eu=!(n=null!=C?C:I)||n.length!==a||n.some(e=>e.length!==a)?h(a):n,ef=(0,l.useCallback)((e,t)=>{var n,r;return(null!=(r=null==Z||null==(n=Z[e])?void 0:n[t])?r:0)>0},[Z]),eh=(0,l.useCallback)((e,t)=>{var n;return!!(null==eu||null==(n=eu[e])?void 0:n[t])},[eu]);(0,l.useEffect)(()=>{g(eu)||(w||U(void 0),K([]),null==A||A(void 0))},[eu,w,A]);let eg=(0,l.useCallback)(e=>{C||F(e),null==M||M(e)},[C,M]),ep=(0,l.useCallback)(e=>{w||U(e),null==A||A(e)},[w,A]),ex=(0,l.useCallback)(e=>{let t=g(eu)?b(eu):ec?[ec]:[];if(!t.length)return!1;for(let[n,r]of t)e(n,r);return!0},[eu,ec]),em=(0,l.useCallback)(e=>{ex((t,n)=>{if(_){Y(r=>{let l=r.map(e=>e.slice());return l[t][n]=e>0?e:0,l}),H(e=>{let r=e.map(e=>e.slice());return r[t][n]=0,r}),$(e=>{let r=e.map(e=>e.map(e=>e.slice()));return r[t][n].fill(0),r}),ee(e=>{let r=e.map(e=>e.map(e=>e.slice()));return r[t][n].fill(0),r});return}ef(t,n)||H(r=>{let l=r.map(e=>e.slice());return l[t][n]=e>0?e:0,l})})},[ex,ef,_]),eb=(0,l.useCallback)((e,t)=>{t<1||t>a||ex((n,r)=>{ef(n,r)||e(e=>{let l=e.map(e=>e.map(e=>e.slice()));return l[n][r][t]=+!l[n][r][t],l})})},[ex,ef,a]),ev=(0,l.useCallback)(e=>{ex((t,n)=>{ef(t,n)||e(e=>{let r=e.map(e=>e.map(e=>e.slice()));return r[t][n].fill(0),r})})},[ex,ef]);(0,l.useImperativeHandle)(t,()=>({annotateColor:e=>{ex((t,n)=>{en(r=>{let l=r.map(e=>e.map(e=>e.slice())),a=l[t][n],o=a.indexOf(e);return o>=0?a.splice(o,1):a.push(e),l})})},annotateClear:()=>{ex((e,t)=>{en(n=>{let r=n.map(e=>e.map(e=>e.slice()));return r[e][t]=[],r})})},setDigit:e=>em(e),toggleCenterNote:e=>eb($,e),toggleCornerNote:e=>eb(ee,e),clearCenterNotes:()=>ev($),clearCornerNotes:()=>ev(ee),exportState:()=>S.buildPayload({size:a,preset:Z,user:q,center:J,corner:Q,colors:et}),importState:e=>{if(!e||!e.startsWith(y))throw Error("Invalid state payload");let t=e.split("|");if(t.length<7)throw Error("Corrupt state: missing segments");let n=N(t[1]);if(n!==a)throw Error("State size ".concat(n," does not match grid size ").concat(a));ea.current++;try{let e=S.decodeNumGrid(t[2],a),n=S.decodeNumGrid(t[3],a),o=S.decodeDigitCube(t[4],a),s=S.decodeDigitCube(t[5],a),i=S.decodeColors(t[6],a);for(let t=0;t<a;t++)for(let i=0;i<a;i++){var r,l;(null!=(l=null==e||null==(r=e[t])?void 0:r[i])?l:0)>0&&(n[t][i]=0,o[t][i].fill(0),s[t][i].fill(0))}Y(e),H(n),$(o),ee(s),en(i)}finally{setTimeout(()=>ea.current--,0)}},reset:()=>{H(v(a)),$(j(a)),ee(j(a)),en(Array.from({length:a},()=>Array.from({length:a},()=>[])))},undo:()=>{let e=er.current;if(!e.length)return!1;let t=el.current;if(t<=0)return!1;let n=e[t-1];ea.current++;try{let e=n.split("|");Y(S.decodeNumGrid(e[2],a)),H(S.decodeNumGrid(e[3],a)),$(S.decodeDigitCube(e[4],a)),ee(S.decodeDigitCube(e[5],a)),en(S.decodeColors(e[6],a)),el.current=t-1}finally{setTimeout(()=>ea.current--,0)}return!0},redo:()=>{let e=er.current;if(!e.length)return!1;let t=el.current;if(t>=e.length-1)return!1;let n=e[t+1];ea.current++;try{let e=n.split("|");Y(S.decodeNumGrid(e[2],a)),H(S.decodeNumGrid(e[3],a)),$(S.decodeDigitCube(e[4],a)),ee(S.decodeDigitCube(e[5],a)),en(S.decodeColors(e[6],a)),el.current=t+1}finally{setTimeout(()=>ea.current--,0)}return!0}}),[eu,ec,ef,a,Z,q,J,Q,et,ex,em,eb,ev]);let ej=(0,l.useCallback)((e,t)=>Math.max(0,Math.min(t-1,e)),[]),ey=(0,l.useCallback)(e=>{let t=B.current;if(!t)return;let n=t.getBoundingClientRect(),r=e.clientX-n.left,l=e.clientY-n.top;if(r<0||l<0||r>n.width||l>n.height)return;let o=ej(Math.floor(r/n.width*a),a);return[ej(Math.floor(l/n.height*a),a),o]},[a,ej]),ek=(0,l.useCallback)(e=>{var t,n,r;let l=ey(e);if(!l)return;null==(t=V.current)||t.focus();let[o,s]=l,i=e.ctrlKey||e.metaKey,d=e.shiftKey,c=i?eu.map(e=>e.slice()):h(a),u=c.map(e=>e.slice()),f=i?c[o][s]?"paint-erase":"paint-add":d?"rect":"paint-add",g={mode:f,start:[o,s],base:c,working:u,visited:new Set([o*a+s]),last:[o,s]};if("rect"===f)(u=h(a))[o][s]=!0,g.working=u,K([[o,s]]),eg(u),ep([o,s]);else if("paint-add"===f)u[o][s]=!0,g.working=u,K(i?e=>x([...e],[o,s]):[[o,s]]),eg(u.map(e=>e.slice())),ep([o,s]);else{u[o][s]=!1,g.working=u,K(e=>m(e,[o,s])),eg(u.map(e=>e.slice()));let e=p(G,[o,s]),t=G.filter(e=>{let[t,n]=e;return t!==o||n!==s});ep(e>0?G[e-1]:t[t.length-1])}X.current=g,W.current=!0,null==(n=(r=e.currentTarget).setPointerCapture)||n.call(r,e.pointerId)},[eu,a,eg,ep,ey,G]),ew=(0,l.useCallback)(e=>{if(!X.current)return;let t=ey(e);if(!t)return;let[n,r]=t,l=X.current;if("rect"===l.mode){let[e,t]=l.start,o=Math.min(e,n),s=Math.max(e,n),i=Math.min(t,r),d=Math.max(t,r),c=h(a);for(let e=o;e<=s;e++)for(let t=i;t<=d;t++)c[e][t]=!0;l.working=c,l.last=[n,r],K(b(c)),eg(c)}else if("paint-add"===l.mode){let e=n*a+r;l.visited.has(e)||(l.visited.add(e),l.working[n][r]=!0,l.last=[n,r],K(e=>x([...e],[n,r])),eg(l.working.map(e=>e.slice())))}else{let e=n*a+r;if(!l.visited.has(e)&&(l.visited.add(e),l.working[n][r])){var o;l.working[n][r]=!1,l.last=[n,r],K(e=>m(e,[n,r])),eg(l.working.map(e=>e.slice())),ec&&(o=[n,r],ec[0]===o[0]&&ec[1]===o[1])&&K(e=>{let t=m(e,[n,r]);return ep(t.length?t[t.length-1]:void 0),t})}}},[a,eg,ey,ec,ep]),eC=(0,l.useCallback)(()=>{var e;if(!X.current)return;let t=X.current;("rect"===t.mode||"paint-add"===t.mode)&&ep(null!=(e=t.last)?e:t.start),X.current=null,W.current=!1},[ep]),eN=(0,l.useCallback)(e=>{eC();try{e.currentTarget.releasePointerCapture(e.pointerId)}catch(e){}},[eC]),eS=(0,l.useCallback)(()=>{W.current&&eC()},[eC]),ez=(0,l.useCallback)((e,t)=>{let n=ec;n||(n=g(eu)?b(eu)[0]:[0,0]);let r=d({row:n[0],col:n[1]},e,t,a),l=[r.row,r.col];ep(l),eg(function(e,t,n){let r=h(e);return r[t][n]=!0,r}(a,l[0],l[1])),K([l])},[ec,eu,a,ep,eg]),eM=(0,l.useCallback)(e=>{let t=e.key;if("Escape"===t){e.preventDefault(),eg(h(a)),ep(void 0),K([]);return}if("ArrowUp"===t||"ArrowDown"===t||"ArrowLeft"===t||"ArrowRight"===t){e.preventDefault(),"ArrowUp"===t&&ez(-1,0),"ArrowDown"===t&&ez(1,0),"ArrowLeft"===t&&ez(0,-1),"ArrowRight"===t&&ez(0,1);return}if("Backspace"===t||"Delete"===t||"0"===t){e.preventDefault(),"center"===k?ev($):"corner"===k?ev(ee):em(0);return}if(/^[1-9]$/.test(t)){let n=parseInt(t,10);n>=1&&n<=Math.min(9,a)&&(e.preventDefault(),"center"===k?eb($,n):"corner"===k?eb(ee,n):em(n))}},[eg,a,ep,ez,k,ev,em,eb]);(0,l.useEffect)(()=>{let e=V.current;e&&(g(eu)||ec)&&document.activeElement!==e&&e.focus()},[k,eu,ec]);let eA=(0,l.useCallback)((e,t)=>{let n=["size-10","border","border-foreground","dark:border-muted","text-center","select-none","cursor-pointer",R].filter(Boolean).join(" "),r=[];if(D){let n=ed(e,t),l=0===e||ed(e-1,t)!==n,o=0===t||ed(e,t-1)!==n,s=t===a-1||ed(e,t+1)!==n,i=e===a-1||ed(e+1,t)!==n;l&&r.push("border-t-2",O),o&&r.push("border-l-2",O),s&&r.push("border-r-2",O),i&&r.push("border-b-2",O)}else{let n=0===e||e%ei.rows==0,l=0===t||t%ei.cols==0,o=t===a-1||(t+1)%ei.cols==0,s=e===a-1||(e+1)%ei.rows==0;n&&r.push("border-t-2",O),l&&r.push("border-l-2",O),o&&r.push("border-r-2",O),s&&r.push("border-b-2",O)}return s(n,r.join(" "))},[D,ed,a,ei,O,R]);return(0,r.jsx)("div",{ref:V,tabIndex:0,onKeyDown:eM,className:"outline-none focus:outline-none",children:(0,r.jsx)("table",{role:"grid","aria-rowcount":a,"aria-colcount":a,children:(0,r.jsx)("tbody",{ref:B,className:o,onPointerDown:ek,onPointerMove:ew,onPointerUp:eN,onPointerLeave:eS,...T,children:Array.from({length:a}).map((e,t)=>(0,r.jsx)("tr",{role:"row",children:Array.from({length:a}).map((e,n)=>{var l,o,i,h,g,p,x,m;let b=t>0?d({row:t,col:n},-1,0,a):null,v=n<a-1?d({row:t,col:n},0,1,a):null,j=t<a-1?d({row:t,col:n},1,0,a):null,y=n>0?d({row:t,col:n},0,-1,a):null,k=!!b&&eh(b.row,b.col),w=!!v&&eh(v.row,v.col),C=!!j&&eh(j.row,j.col),N=!!y&&eh(y.row,y.col),S=n>0&&t>0&&!eh(t-1,n-1)&&k&&N,z=n<a-1&&t>0&&!eh(t-1,n+1)&&k&&w,M=n>0&&t<a-1&&!eh(t+1,n-1)&&C&&N,A=n<a-1&&t<a-1&&!eh(t+1,n+1)&&C&&w,E=eh(t,n),D=null!=(p=null==Z||null==(l=Z[t])?void 0:l[n])?p:0,R=null!=(x=null==q||null==(o=q[t])?void 0:o[n])?x:0,O=D>0?D:R>0?R:"",T=D||R||null==J||null==(i=J[t])?void 0:i[n],P=D||R||null==Q||null==(h=Q[t])?void 0:h[n],L=Math.min(9,a),U=[],I=[];if(T)for(let e=1;e<=L;e++)T[e]&&U.push(e);if(P)for(let e=1;e<=L;e++)P[e]&&I.push(e);let F=U.length>0?c.slice(0,8):c,G=null!=(m=null==et||null==(g=et[t])?void 0:g[n])?m:[];return(0,r.jsx)("td",{role:"gridcell",className:eA(t,n),children:(0,r.jsxs)("div",{"aria-selected":E,"aria-readonly":!_&&ef(t,n)||void 0,className:s("relative flex size-full cursor-pointer items-center justify-center text-2xl select-none","[--sel:theme(colors.blue.300)] dark:[--sel:theme(colors.blue.800)]",ef(t,n)?"text-foreground":"text-blue-700 dark:text-blue-400 font-bold font-serif"),children:[G.length>0&&(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 flex overflow-hidden",children:G.map((e,t)=>(0,r.jsx)("div",{className:s("h-full flex-1",f[e])},t))}),E&&(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 z-10 bg-white/20 dark:bg-black/10"}),E&&!N&&(0,r.jsx)("span",{className:"pointer-events-none absolute top-0 bottom-0 left-0 z-20 w-[4px]",style:{background:"var(--sel)"}}),E&&!w&&(0,r.jsx)("span",{className:"pointer-events-none absolute top-0 right-0 bottom-0 z-20 w-[4px]",style:{background:"var(--sel)"}}),E&&!k&&(0,r.jsx)("span",{className:"pointer-events-none absolute top-0 right-0 left-0 z-20 h-[4px]",style:{background:"var(--sel)"}}),E&&!C&&(0,r.jsx)("span",{className:"pointer-events-none absolute right-0 bottom-0 left-0 z-20 h-[4px]",style:{background:"var(--sel)"}}),E&&S&&(0,r.jsx)("span",{className:"absolute top-0 left-0 z-20 size-[4px] rounded-br-xs bg-(--sel)"}),E&&z&&(0,r.jsx)("span",{className:"absolute top-0 right-0 z-20 size-[4px] rounded-bl-xs bg-(--sel)"}),E&&M&&(0,r.jsx)("span",{className:"absolute bottom-0 left-0 z-20 size-[4px] rounded-tr-xs bg-(--sel)"}),E&&A&&(0,r.jsx)("span",{className:"absolute right-0 bottom-0 z-20 size-[4px] rounded-tl-xs bg-(--sel)"}),""!==O&&(0,r.jsx)("span",{className:"absolute",children:O}),""===O&&I.length>0&&(0,r.jsx)(r.Fragment,{children:I.slice(0,9).map((e,t)=>{let n=F[t];return n?(0,r.jsx)("span",{className:s(u[n],"text-xxs leading-none font-semibold tracking-tight"),children:e},"".concat(e,"-").concat(t)):null})}),""===O&&U.length>0&&(0,r.jsx)("span",{className:"absolute text-xs leading-none font-semibold tracking-tight",children:U.join("")})]})},n)})},t))})})})}),D=l.memo(E);var R=n(1887),O=n(3101);let _=(0,O.F)("\n    inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap\n    transition-[color,box-shadow] outline-none\n    hover:bg-muted hover:text-muted-foreground\n    focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n    disabled:pointer-events-none disabled:opacity-50\n    aria-invalid:border-destructive aria-invalid:ring-destructive/20\n    data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\n    dark:aria-invalid:ring-destructive/40\n    [&_svg]:pointer-events-none [&_svg]:shrink-0\n    [&_svg:not([class*='size-'])]:size-4\n  ",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 min-w-9 px-2",sm:"h-8 min-w-8 px-1.5",lg:"h-10 min-w-10 px-2.5"}},defaultVariants:{variant:"default",size:"default"}});function T(e){let{className:t,variant:n,size:l,...a}=e;return(0,r.jsx)(R.b,{"data-slot":"toggle",className:s(_({variant:n,size:l,className:t})),...a})}var P=n(2467);let L=(0,O.F)("\n    inline-flex shrink-0 items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap\n    transition-all outline-none\n    focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n    disabled:pointer-events-none disabled:opacity-50\n    aria-invalid:border-destructive aria-invalid:ring-destructive/20\n    dark:aria-invalid:ring-destructive/40\n    [&_svg]:pointer-events-none [&_svg]:shrink-0\n    [&_svg:not([class*='size-'])]:size-4\n  ",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"\n          bg-destructive text-white shadow-xs\n          hover:bg-destructive/90\n          focus-visible:ring-destructive/20\n          dark:bg-destructive/60 dark:focus-visible:ring-destructive/40\n        ",outline:"\n          border bg-background shadow-xs\n          hover:bg-accent hover:text-accent-foreground\n          dark:border-input dark:bg-input/30 dark:hover:bg-input/50\n        ",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 gap-1.5 rounded-md px-3 has-[>svg]:px-2.5",lg:"has-[>svg ]:px-4 h-10 rounded-md px-6",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function U(e){let{className:t,variant:n,size:l,asChild:a=!1,...o}=e,i=a?P.DX:"button";return(0,r.jsx)(i,{"data-slot":"button",className:s(L({variant:n,size:l,className:t})),...o})}var I=n(7268);function F(e){let{className:t,orientation:n="horizontal",decorative:l=!0,...a}=e;return(0,r.jsx)(I.b,{"data-slot":"separator",decorative:l,orientation:n,className:s("\n          shrink-0 bg-border\n          data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full\n          data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\n        ",t),...a})}var G=n(8514),K=n(2794),V=n(5523),B=n(9295),W=n(1300),X=n(5917),Z=n(9051),Y=n(7937);function q(e){let{className:t,...n}=e;return(0,r.jsx)(W.bL,{"data-slot":"menubar",className:s("flex h-9 items-center gap-1 rounded-md border bg-background p-1 shadow-xs",t),...n})}function H(e){let{...t}=e;return(0,r.jsx)(W.W1,{"data-slot":"menubar-menu",...t})}function J(e){let{...t}=e;return(0,r.jsx)(W.ZL,{"data-slot":"menubar-portal",...t})}function $(e){let{...t}=e;return(0,r.jsx)(W.z6,{"data-slot":"menubar-radio-group",...t})}function Q(e){let{className:t,...n}=e;return(0,r.jsx)(W.l9,{"data-slot":"menubar-trigger",className:s("\n          flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none\n          focus:bg-accent focus:text-accent-foreground\n          data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\n        ",t),...n})}function ee(e){let{className:t,align:n="start",alignOffset:l=-4,sideOffset:a=8,...o}=e;return(0,r.jsx)(J,{children:(0,r.jsx)(W.UC,{"data-slot":"menubar-content",align:n,alignOffset:l,sideOffset:a,className:s("\n            z-50 min-w-[12rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border\n            bg-popover p-1 text-popover-foreground shadow-md\n            data-[side=bottom]:slide-in-from-top-2\n            data-[side=left]:slide-in-from-right-2\n            data-[side=right]:slide-in-from-left-2\n            data-[side=top]:slide-in-from-bottom-2\n            data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95\n            data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95\n          ",t),...o})})}function et(e){let{className:t,inset:n,variant:l="default",...a}=e;return(0,r.jsx)(W.q7,{"data-slot":"menubar-item","data-inset":n,"data-variant":l,className:s("\n          relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none\n          focus:bg-accent focus:text-accent-foreground\n          data-[disabled]:pointer-events-none data-[disabled]:opacity-50\n          data-[inset]:pl-8\n          data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10\n          data-[variant=destructive]:focus:text-destructive\n          dark:data-[variant=destructive]:focus:bg-destructive/20\n          [&_svg]:pointer-events-none [&_svg]:shrink-0\n          [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground\n          data-[variant=destructive]:*:[svg]:!text-destructive\n        ",t),...a})}function en(e){let{className:t,children:n,checked:l,...a}=e;return(0,r.jsxs)(W.H_,{"data-slot":"menubar-checkbox-item",className:s("\n          relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none\n          focus:bg-accent focus:text-accent-foreground\n          data-[disabled]:pointer-events-none data-[disabled]:opacity-50\n          [&_svg]:pointer-events-none [&_svg]:shrink-0\n          [&_svg:not([class*='size-'])]:size-4\n        ",t),checked:l,...a,children:[(0,r.jsx)("span",{className:"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(W.VF,{children:(0,r.jsx)(X.A,{className:"size-4"})})}),n]})}function er(e){let{className:t,children:n,...l}=e;return(0,r.jsxs)(W.hN,{"data-slot":"menubar-radio-item",className:s("\n          relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none\n          focus:bg-accent focus:text-accent-foreground\n          data-[disabled]:pointer-events-none data-[disabled]:opacity-50\n          [&_svg]:pointer-events-none [&_svg]:shrink-0\n          [&_svg:not([class*='size-'])]:size-4\n        ",t),...l,children:[(0,r.jsx)("span",{className:"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(W.VF,{children:(0,r.jsx)(Z.A,{className:"size-2 fill-current"})})}),n]})}function el(e){let{className:t,...n}=e;return(0,r.jsx)(W.wv,{"data-slot":"menubar-separator",className:s("-mx-1 my-1 h-px bg-border",t),...n})}function ea(e){let{className:t,...n}=e;return(0,r.jsx)("span",{"data-slot":"menubar-shortcut",className:s("ml-auto text-xs tracking-widest text-muted-foreground",t),...n})}function eo(e){let{...t}=e;return(0,r.jsx)(W.Pb,{"data-slot":"menubar-sub",...t})}function es(e){let{className:t,inset:n,children:l,...a}=e;return(0,r.jsxs)(W.ZP,{"data-slot":"menubar-sub-trigger","data-inset":n,className:s("\n          flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-none select-none\n          focus:bg-accent focus:text-accent-foreground\n          data-[inset]:pl-8\n          data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\n        ",t),...a,children:[l,(0,r.jsx)(Y.A,{className:"ml-auto h-4 w-4"})]})}function ei(e){let{className:t,...n}=e;return(0,r.jsx)(W.G5,{"data-slot":"menubar-sub-content",className:s("\n          z-50 min-w-[8rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border\n          bg-popover p-1 text-popover-foreground shadow-lg\n          data-[side=bottom]:slide-in-from-top-2\n          data-[side=left]:slide-in-from-right-2\n          data-[side=right]:slide-in-from-left-2\n          data-[side=top]:slide-in-from-bottom-2\n          data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95\n          data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95\n        ",t),...n})}function ed(e){let{expertMode:t,setExpertMode:n,isDark:l,setIsDark:a,notesMode:o,setNotesMode:s,onMenuUndo:i,onMenuRedo:d,onMenuReset:c,onMenuSaveFile:u,onMenuShareLink:f,onMenuOpenFile:h,onMenuCopyPayload:g,onMenuPastePayload:p,setUploadOpen:x,handleShare:m,editorialMode:b,setEditorialMode:v}=e;return(0,r.jsxs)(q,{className:"w-fit",children:[(0,r.jsxs)(H,{children:[(0,r.jsx)(Q,{children:"File"}),(0,r.jsxs)(ee,{children:[t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(eo,{children:[(0,r.jsx)(es,{children:"Save..."}),(0,r.jsxs)(ei,{children:[(0,r.jsxs)(et,{onClick:m,children:["Show saving dialog",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"S"})]})]}),(0,r.jsxs)(et,{onClick:u,children:["Save file",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"Shift"}),(0,r.jsx)("kbd",{children:"S"})]})]}),(0,r.jsx)(et,{onClick:f,children:"Share link"}),t&&(0,r.jsx)(et,{onClick:g,children:"Copy SG1 payload"})]})]}),(0,r.jsxs)(eo,{children:[(0,r.jsx)(es,{children:"Open..."}),(0,r.jsxs)(ei,{children:[(0,r.jsxs)(et,{onClick:()=>x(!0),children:["Show opening dialog",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"O"})]})]}),(0,r.jsxs)(et,{onClick:h,children:["Open file",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"Shift"}),(0,r.jsx)("kbd",{children:"O"})]})]}),(0,r.jsx)(et,{onClick:p,children:"Paste SG1 payload"})]})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(et,{onClick:m,children:["Save",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"S"})]})]}),(0,r.jsxs)(et,{onClick:()=>x(!0),children:["Open",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"O"})]})]})]}),(0,r.jsx)(el,{}),(0,r.jsxs)(et,{onClick:c,children:["Reset current puzzle",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"R"})]})]})]})]}),(0,r.jsxs)(H,{children:[(0,r.jsx)(Q,{children:"Edit"}),(0,r.jsxs)(ee,{children:[(0,r.jsxs)(et,{inset:!0,onClick:i,children:["Undo",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"Z"})]})]}),(0,r.jsxs)(et,{inset:!0,onClick:d,children:["Redo",(0,r.jsxs)(ea,{children:[(0,r.jsx)("kbd",{children:"Ctrl"}),(0,r.jsx)("kbd",{children:"Y"})]})]}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(el,{}),(0,r.jsx)(en,{checked:b,onCheckedChange:e=>v(e),children:"Editorial Mode"})]})]})]}),(0,r.jsxs)(H,{children:[(0,r.jsx)(Q,{children:"View"}),(0,r.jsxs)(ee,{children:[(0,r.jsxs)($,{value:o||"normal",onValueChange:e=>s(e),children:[(0,r.jsxs)(er,{value:"normal",children:["Normal",(0,r.jsx)(ea,{children:(0,r.jsx)("kbd",{children:"N"})})]}),(0,r.jsxs)(er,{value:"center",children:["Center Notes",(0,r.jsx)(ea,{children:(0,r.jsx)("kbd",{children:"X"})})]}),(0,r.jsxs)(er,{value:"corner",children:["Corner Notes",(0,r.jsx)(ea,{children:(0,r.jsx)("kbd",{children:"C"})})]}),(0,r.jsxs)(er,{value:"color",children:["Color Annotations",(0,r.jsx)(ea,{children:(0,r.jsx)("kbd",{children:"V"})})]})]}),(0,r.jsx)(el,{}),(0,r.jsx)(en,{checked:l,onCheckedChange:e=>a(e),children:"Dark Mode"}),(0,r.jsx)(el,{}),(0,r.jsx)(en,{checked:t,onCheckedChange:e=>n(e),children:"Expert Mode"})]})]})]})}var ec=n(9511),eu=n(5229);function ef(e){let{...t}=e;return(0,r.jsx)(ec.bL,{"data-slot":"dialog",...t})}function eh(e){let{...t}=e;return(0,r.jsx)(ec.ZL,{"data-slot":"dialog-portal",...t})}function eg(e){let{className:t,...n}=e;return(0,r.jsx)(ec.hJ,{"data-slot":"dialog-overlay",className:s("\n          fixed inset-0 z-50 bg-black/50\n          data-[state=closed]:animate-out data-[state=closed]:fade-out-0\n          data-[state=open]:animate-in data-[state=open]:fade-in-0\n        ",t),...n})}function ep(e){let{className:t,children:n,showCloseButton:l=!0,...a}=e;return(0,r.jsxs)(eh,{"data-slot":"dialog-portal",children:[(0,r.jsx)(eg,{}),(0,r.jsxs)(ec.UC,{"data-slot":"dialog-content",className:s("\n            fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%]\n            gap-4 rounded-lg border bg-background p-6 shadow-lg duration-200\n            data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95\n            data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95\n            sm:max-w-lg\n          ",t),...a,children:[n,l&&(0,r.jsxs)(ec.bm,{"data-slot":"dialog-close",className:"\n              absolute top-4 right-4 rounded-xs opacity-70 ring-offset-background transition-opacity\n              hover:opacity-100\n              focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:outline-hidden\n              disabled:pointer-events-none\n              data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\n              [&_svg]:pointer-events-none [&_svg]:shrink-0\n              [&_svg:not([class*='size-'])]:size-4\n            ",children:[(0,r.jsx)(eu.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function ex(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"dialog-header",className:s("flex flex-col gap-2 text-center sm:text-left",t),...n})}function em(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"dialog-footer",className:s("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...n})}function eb(e){let{className:t,...n}=e;return(0,r.jsx)(ec.hE,{"data-slot":"dialog-title",className:s("text-lg leading-none font-semibold",t),...n})}function ev(e){let{className:t,...n}=e;return(0,r.jsx)(ec.VY,{"data-slot":"dialog-description",className:s("text-sm text-muted-foreground",t),...n})}var ej=n(489);function ey(e){let{className:t,...n}=e;return(0,r.jsx)(ej.b,{"data-slot":"label",className:s("\n          flex items-center gap-2 text-sm leading-none font-medium select-none\n          group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50\n          peer-disabled:cursor-not-allowed peer-disabled:opacity-50\n        ",t),...n})}function ek(e){let{className:t,...n}=e;return(0,r.jsx)("textarea",{"data-slot":"textarea",className:s("\n          flex field-sizing-content min-h-16 w-full rounded-md border border-input bg-transparent px-3 py-2 text-base\n          shadow-xs transition-[color,box-shadow] outline-none\n          placeholder:text-muted-foreground\n          focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50\n          disabled:cursor-not-allowed disabled:opacity-50\n          aria-invalid:border-destructive aria-invalid:ring-destructive/20\n          md:text-sm\n          dark:bg-input/30 dark:aria-invalid:ring-destructive/40\n        ",t),...n})}var ew=n(6701);function eC(e){let{open:t,setOpen:n,onImportText:a}=e,[o,s]=(0,l.useState)(""),[i,d]=(0,l.useState)(null),c=(0,l.useRef)(null),u=(0,l.useRef)(null),f=async e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];n&&(s((await n.text()).trim()),d(null),e.target.value="")};return(0,r.jsx)(ef,{open:t,onOpenChange:n,children:(0,r.jsxs)(ep,{children:[(0,r.jsxs)(ex,{children:[(0,r.jsx)(eb,{children:"Upload sudoku state"}),(0,r.jsx)(ev,{children:"Paste your SG1 payload or choose a file from your device."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(ey,{htmlFor:"sg1",children:"Sudoku state"}),(0,r.jsx)(ek,{id:"sg1",placeholder:"".concat(y,"..."),value:o,onChange:e=>s(e.target.value),"aria-invalid":!!i||void 0,spellCheck:!1,ref:u}),i?(0,r.jsx)("p",{className:"text-sm text-destructive",children:i}):(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Tip: payload should start with ",y]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(U,{variant:"outline",className:"w-full",onClick:()=>{var e;return null==(e=c.current)?void 0:e.click()},type:"button",children:[(0,r.jsx)(ew.A,{size:12})," Choose file"]}),(0,r.jsx)("input",{ref:c,type:"file",accept:".txt,.sg1",className:"hidden",onChange:f})]})]}),(0,r.jsxs)(em,{children:[(0,r.jsx)(U,{variant:"outline",onClick:()=>n(!1),type:"button",children:"Cancel"}),(0,r.jsx)(U,{onClick:()=>{let e=o.trim();return e?e.startsWith(y)?void(d(null),a(e),n(!1),s("")):void d("Invalid payload. Expected text starting with ".concat(y)):void d("Please paste a state or choose a file.")},type:"button",children:"Send"})]})]})})}function eN(e){let{open:t,setOpen:n,text:l,onCopy:a,onDownload:o}=e;return(0,r.jsx)(ef,{open:t,onOpenChange:n,children:(0,r.jsxs)(ep,{children:[(0,r.jsxs)(ex,{children:[(0,r.jsx)(eb,{children:"Export sudoku state"}),(0,r.jsx)(ev,{children:"Copy or download your SG1 payload."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(ey,{htmlFor:"sg1-out",children:"Sudoku state"}),(0,r.jsx)(ek,{id:"sg1-out",value:l,readOnly:!0,spellCheck:!1})]}),(0,r.jsxs)(em,{children:[(0,r.jsx)(U,{variant:"outline",onClick:()=>n(!1),type:"button",children:"Close"}),(0,r.jsx)(U,{variant:"secondary",onClick:a,type:"button",children:"Copy"}),(0,r.jsx)(U,{onClick:o,type:"button",children:"Download"})]})]})})}function eS(e){let{className:t,type:n,...l}=e;return(0,r.jsx)("input",{type:n,"data-slot":"input",className:s("\n          flex h-9 w-full min-w-0 rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-xs\n          transition-[color,box-shadow] outline-none\n          selection:bg-primary selection:text-primary-foreground\n          file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground\n          placeholder:text-muted-foreground\n          disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50\n          md:text-sm\n          dark:bg-input/30\n        ","focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50","aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40",t),...l})}let ez=["red","orange","yellow","green","cyan","blue","violet","pink","transparent"],eM=[1,2,3,4,5,6,7,8,9,0],eA={1:"tl",2:"tc",3:"tr",4:"lc",5:"cc",6:"rc",7:"bl",8:"bc",9:"br"};async function eE(e){try{var t;return await (null==(t=navigator.clipboard)?void 0:t.writeText(e)),!0}catch(e){return console.error(e),alert("Failed to copy"),!1}}function eD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sudoku.sg1.txt",n=new Blob([e],{type:"text/plain"}),r=URL.createObjectURL(n),l=document.createElement("a");l.href=r,l.download=t,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(r)}function eR(e){let{mode:t,setMode:n}=e;return(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsxs)(T,{variant:"outline","aria-label":"Toggle Center Notes Mode",title:"Center Notes Mode (X)",pressed:"center"===t,onPressedChange:e=>n(e?"center":null),children:[(0,r.jsx)("span",{className:"sr-only",children:"Center Notes"}),(0,r.jsx)(G.A,{})]}),(0,r.jsxs)(T,{variant:"outline","aria-label":"Toggle Corner Notes Mode",title:"Corner Notes Mode (C)",pressed:"corner"===t,onPressedChange:e=>n(e?"corner":null),children:[(0,r.jsx)("span",{className:"sr-only",children:"Corner Notes"}),(0,r.jsx)(K.A,{})]}),(0,r.jsxs)(T,{variant:"outline","aria-label":"Toggle Color Annotation Mode",title:"Color Annotation Mode (V)",pressed:"color"===t,onPressedChange:e=>n(e?"color":null),children:[(0,r.jsx)("span",{className:"sr-only",children:"Color Annotations"}),(0,r.jsx)(V.A,{})]})]})}function eO(e){let{mode:t,onClick:n}=e,l="color"===t,a="center"===t,o="corner"===t;return(0,r.jsx)("div",{className:"grid w-fit grid-cols-3 gap-1",children:Array.from({length:10}).map((e,t)=>{let i=eM[t],d=l&&9===t,c=l?d?"Clear color from selection":"Apply ".concat(ez[t]," color to selection"):a?"Toggle center note ".concat(i):o?"Toggle corner note ".concat(i):"Set digit ".concat(i),h=l?d?"Clear all colors":"Toggle ".concat(ez[t]," color"):a||o?0===i?"Clear notes":"".concat(a?"Center":"Corner"," note ").concat(i):0===i?"Clear value":"Place ".concat(i),g=(()=>{if(0===i)return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"sr-only",children:"Clear"}),(0,r.jsx)(B.A,{})]});if(l){let e=ez[t];return(0,r.jsx)("span",{"aria-hidden":!0,className:s("size-4 rounded-xs border border-foreground/10",f[e])})}if(o){let e=eA[i];return(0,r.jsx)("span",{className:s(u[e],"font-serif text-xxs leading-none font-semibold tracking-tight"),children:i})}return(0,r.jsx)("span",{className:a?"text-xs font-serif":"text-base",children:i})})();return(0,r.jsx)(U,{size:"icon",variant:"outline","aria-label":c,title:h,className:s("relative",0===i?"col-start-2":void 0),onClick:()=>n(t),children:g},t)})})}function e_(){let[e,t]=(0,l.useState)(),[n,a]=(0,l.useState)(Array.from({length:9},()=>Array(9).fill(!1))),[o,s]=(0,l.useState)(null),[i,d]=(0,l.useState)(!1),[c,u]=(0,l.useState)(!1),[f,h]=(0,l.useState)(""),[g,p]=(0,l.useState)(""),x=(0,l.useRef)(null),[m,b]=(0,l.useState)(!1),[v,j]=(0,l.useState)(!1),[k,w]=(0,l.useState)(""),{isDark:C,setIsDark:N}=function(){let[e,t]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{try{var e,n;let r=localStorage.getItem("theme"),l=null==(e=(n=window).matchMedia)?void 0:e.call(n,"(prefers-color-scheme: dark)").matches,a=r?"dark"===r:!!l;t(a),"undefined"!=typeof document&&document.documentElement.classList.toggle("dark",a)}catch(e){}},[]),(0,l.useEffect)(()=>{try{"undefined"!=typeof document&&document.documentElement.classList.toggle("dark",e),localStorage.setItem("theme",e?"dark":"light")}catch(e){}},[e]),{isDark:e,setIsDark:t}}(),S=(0,l.useCallback)(async()=>{var e,t;let n=null!=(t=null==(e=x.current)?void 0:e.exportState())?t:"";if(!n||!(f||g))return n;try{let e=await M({title:f,rules:g});return(n.endsWith("|")?n:n+"|")+e}catch(e){return console.warn("Failed to encode metadata segment",e),n}},[f,g]),z=(0,l.useCallback)(async()=>{let e=await S();e&&(w(e),j(!0))},[S]),E=(0,l.useCallback)(async e=>{if(!(null==e?void 0:e.startsWith(y)))return alert("Invalid payload"),!1;try{var t;null==(t=x.current)||t.importState(e),h(""),p("");let n=e.split("|");for(let e=0;e<n.length-1;e++){let t=n[e],r=n[e+1];if(t&&t.startsWith("M1")&&r){let e=await A("".concat(t,"|").concat(r));e&&(h(e.title||""),p(e.rules||""));break}}return!0}catch(e){return console.error(e),alert(e.message||"Failed to import"),!1}},[]);(0,l.useEffect)(()=>{try{let e=new URL(window.location.href),t=e.searchParams.get("state")||e.hash.replace(/^#state=/,"");if(!t)return;E(decodeURIComponent(t))}catch(e){console.error(e)}},[]),(0,l.useEffect)(()=>{i||u(!1)},[i]),(0,l.useCallback)(()=>{var e,t;return null!=(t=null==(e=x.current)?void 0:e.exportState())?t:""},[]);let R=(0,l.useCallback)(async()=>{let e=await S();e&&eD(e)},[S]),O=(0,l.useCallback)(async()=>{let e=await S();if(!e)return;let t=new URL(window.location.href);t.searchParams.set("state",e),await eE(t.toString()),alert("Share link copied to clipboard")},[S]),_=(0,l.useCallback)(async()=>{let e=await S();e&&await eE(e)},[S]),T=(0,l.useCallback)(()=>{b(!0),setTimeout(()=>{let e=document.querySelector('input[type="file"][accept=".txt,.sg1"]');null==e||e.click()},0)},[]),P=(0,l.useCallback)(()=>{b(!0),setTimeout(()=>{let e=document.getElementById("sg1");null==e||e.focus()},0)},[]),L=(0,l.useCallback)(()=>{var e;return null==(e=x.current)?void 0:e.reset()},[]),U=(0,l.useCallback)(()=>{var e;return null==(e=x.current)?void 0:e.undo()},[]),I=(0,l.useCallback)(()=>{var e;return null==(e=x.current)?void 0:e.redo()},[]),{uploadOpen:G,exportOpen:K,notesMode:V,setNotesMode:B,onReset:W,onUndo:X,onRedo:Z,openUploadDialog:Y,saveFile:q,openFile:H}={uploadOpen:m,exportOpen:v,notesMode:o,setNotesMode:s,onReset:L,onUndo:U,onRedo:I,openUploadDialog:()=>b(!0),saveFile:R,openFile:T};(0,l.useEffect)(()=>{let e=e=>{let t=(e=>{if(!(e instanceof HTMLElement))return!1;let t=e.tagName;return e.isContentEditable||"INPUT"===t||"TEXTAREA"===t||"SELECT"===t})(e.target);if(e.ctrlKey||e.metaKey)if(e.shiftKey||e.altKey){if(e.shiftKey&&!e.altKey){if("s"===e.key||"S"===e.key){e.preventDefault(),q();return}if("o"===e.key||"O"===e.key){e.preventDefault(),H();return}}}else{if(t)return;if("o"===e.key||"O"===e.key){e.preventDefault(),Y();return}if("r"===e.key||"R"===e.key){e.preventDefault(),W();return}if("z"===e.key||"Z"===e.key){e.preventDefault(),X();return}if("y"===e.key||"Y"===e.key){e.preventDefault(),Z();return}}t||G||K||e.ctrlKey||e.metaKey||e.altKey||(("n"===e.key||"N"===e.key)&&B(null),("x"===e.key||"X"===e.key)&&B("center"===V?null:"center"),("c"===e.key||"C"===e.key)&&B("corner"===V?null:"corner"),("v"===e.key||"V"===e.key)&&B("color"===V?null:"color"))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[G,K,V,B,W,X,Z,Y,q,H]);let J=(0,l.useCallback)(e=>{var t,n,r,l,a,s,i;let d="color"===o,c="center"===o,u="corner"===o;if(d){if(e<ez.length){let t=ez[e];null==(n=x.current)||n.annotateColor(t)}else null==(r=x.current)||r.annotateClear();return}let f=eM[e];return c?void(0===f?null==(l=x.current)||l.clearCenterNotes():null==(a=x.current)||a.toggleCenterNote(f)):u?void(0===f?null==(s=x.current)||s.clearCornerNotes():null==(i=x.current)||i.toggleCornerNote(f)):void(null==(t=x.current)||t.setDigit(f))},[o]),$=(0,l.useCallback)(async()=>{await eE(k)},[k]),Q=(0,l.useCallback)(()=>eD(k),[k]);return(0,r.jsxs)("div",{className:"space-y-4 p-4",children:[(0,r.jsx)(ed,{expertMode:i,setExpertMode:d,isDark:C,setIsDark:N,notesMode:o,setNotesMode:s,onMenuUndo:U,onMenuRedo:I,onMenuReset:L,onMenuSaveFile:R,onMenuShareLink:O,onMenuOpenFile:T,onMenuCopyPayload:_,onMenuPastePayload:P,setUploadOpen:b,handleShare:z,editorialMode:c,setEditorialMode:u}),(0,r.jsxs)("div",{className:"flex w-fit flex-col gap-4 md:flex-row",children:[(0,r.jsx)(D,{ref:x,pencilMode:"center"===o?"center":"corner"===o?"corner":null,currentCell:e,selectedCells:n,onSelectionChange:a,onCurrentCellChange:t,editorialMode:c,onCellSelect:e=>{let{row:t,col:n}=e;console.log("Clicked:",t,n)}}),c?(0,r.jsxs)("div",{className:"flex flex-col gap-2 md:w-72",children:[(0,r.jsx)(eS,{placeholder:"Sudoku Title",className:"w-full",value:f,onChange:e=>h(e.target.value)}),(0,r.jsx)(ek,{placeholder:"Enter ruleset hereâ€¦",className:"w-full text-justify break-words whitespace-pre-wrap md:h-full",value:g,onChange:e=>p(e.target.value)})]}):(f||g)&&(0,r.jsxs)("div",{className:"\n                flex size-fit max-w-90.5 flex-col rounded-md border px-3 py-2 text-justify text-sm break-words\n                hyphens-auto whitespace-pre-wrap\n                md:w-72\n              ",children:[f&&(0,r.jsx)("h3",{className:"not-last:mb-1",children:f}),(0,r.jsx)("span",{children:g})]})]}),(0,r.jsxs)("div",{className:"flex w-fit flex-col gap-2 rounded-md border p-2",children:[(0,r.jsx)(eR,{mode:o,setMode:s}),(0,r.jsx)(F,{}),(0,r.jsx)(eO,{mode:o,onClick:J})]}),(0,r.jsx)(eC,{open:m,setOpen:b,onImportText:e=>{E(e)}}),(0,r.jsx)(eN,{open:v,setOpen:j,text:k,onCopy:$,onDownload:Q})]})}},7767:(e,t,n)=>{Promise.resolve().then(n.bind(n,5935))}},e=>{e.O(0,[69,441,255,358],()=>e(e.s=7767)),_N_E=e.O()}]);